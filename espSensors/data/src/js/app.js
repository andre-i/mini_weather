function Measurer(e,l){"use strict";var t=navigator.userAgent.toLowerCase(),S=!(t.search("firefox")<0);S&&58.9<t.substring(t.length-4)&&(S=!1);var c,r={strokeCol:"#744",devBordStartCol:"#eef",devBordStopCol:"#851",fill:"#ffe",textCol:"#332",brightnessCol:"#fff",devBorderCol:"#530",labelCol:"#322",scaleCol:"red",scaleBordCol:"#132",arrStrokeCol:"#010",arrFillCol:"#864"},n={minValue:0,maxValue:100,scaleDivideCount:10},o={height:Math.round(.36*a()),width:Math.round(.12*a()),curValue:0,strokeWidth:1,hasScaleLabels:!0,hasLabel:!0,hasEdgeCircle:!0,hasGlass:!0,hasRoundRect:!0,label:""},i={label:"",alpha:0,startAngle:0,stopAngle:180,width:Math.round(a()/4.1),strokeWidth:1,hasRound:!0};function a(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)}var s=(Math.random()*(new Date).getSeconds()+"").substring(0,6),m=document.createElement("div"),f=document.createElement("div");f.appendChild(m),f.setAttribute("class","bigSize");var d,g=document.getElementsByTagName("body")[0];var h={};if(l){if(null==e||!(e instanceof HTMLElement))return console.log(" new created device has no owner container(tag) i get - "+e),void(d=null);d=null,function(){var e;for(var t in l.hasOwnProperty("bounds")&&(e=l.bounds),n)e&&e.hasOwnProperty(t)?h[t]=e[t]:h[t]=n[t]}(),function(){var e;for(var t in l.hasOwnProperty("colors")&&(e=l.colors),r)e&&e.hasOwnProperty(t)?h[t]=e[t]:h[t]=r[t]}(),h.owner=e,l.hasOwnProperty("rect")&&(!function(){var e=l.rect;for(var t in o)e&&e.hasOwnProperty(t)?h[t]=e[t]:h[t]=o[t];e&&e.hasOwnProperty("fontSize")&&(o.fontSize=e.fontSize),e&&e.hasOwnProperty("scaleWidth")&&(o.scaleWidth=e.scaleWidth)}(),d=function(C){var r,A,k,M,T,L,E,N,B=!1,O=0,I=null,S=null,D=null,W=null,n=0,o=!1;function e(e){if(null==W)return!1;if(e>C.maxValue||e<C.minValue)return console.log("WARNING linearDevice get wrong current value "+e),a(n="ERR"),!1;n=e;var t=(e-=C.minValue)*k/Math.abs(C.minValue-C.maxValue),r=""+(T-t);return W.setAttribute("y",r),W.setAttribute("height",""+t),o&&a(n),!0}function t(e){a((o=e)?n:"?")}function i(e){A=C.hasOwnProperty("scaleWidth")?Math.round(C.scaleWidth*C.width/100):Math.round(C.width/10),T=Math.round(.87*C.height),L=Math.round(.12*C.height),M=(k=T-L)/C.scaleDivideCount,N=C.height/40,C.strokeWidth=Math.round(C.height/200),N<2&&(N=2),E=Math.round(C.width/2-N),O=k/C.scaleDivideCount-4*C.strokeWidth,e&&O<8&&(O=8)}function a(e){return null!=D&&(D.textContent=""+e,!0)}var l,s,d=!1;function H(){d?d&&(f.parentNode.removeChild(f),m.innerHTML="",C.height=l,C.width=s,O=c,i(!0),h(C.owner),e(n),d=!1):d||(g.appendChild(f),c=O,l=C.height,s=C.width,C.height=Math.round(.85*document.body.clientHeight),C.width=Math.round(s*C.height/l),i(!0),m.setAttribute("style","height:"+C.height+"px;padding-top:"+3*C.height/34+"px;"),h(m),e(n),d=!0)}function P(){t(!o)}function h(e){var t,r,n;B?(n=C.width,r=C.height,t=" transform='rotate(90) translate(0, -"+C.height+")' >"):(n=C.height,r=C.width,t=" >"),e.innerHTML="<svg width='"+r+"' height='"+n+"' viewBox='0,0 "+r+" "+n+"' xmlns='http://www.w3.org/2000/svg'></svg>",I=e.getElementsByTagName("svg")[0];var o,i,a,l,s,d,h,u,c,m,f,g,b,v,x,w,p,y="<g id='"+C.id+"group' "+t;return y+=function(){C.gradId=C.brightnessId+"Rgrad";var e="<defs> <radialGradient id='"+C.gradId+"' cx='50%' cy='50%' > ";return e+=" <stop offset='25%' stop-color='"+C.devBordStartCol+"' opacity='0.5' />",e+=" <stop offset='75%' stop-color='"+C.devBordStartCol+"'/>",e+="  <stop offset='99%' stop-color='"+C.devBordStopCol+"'  />",e+="</radialGradient>"}(),y+="<linearGradient  id='"+C.id+"scale' x1='0' y1='0' x2='100%' y2='0' ><stop offset='0%' stop-color='black' stop-opacity='0.5' /><stop offset='37%' stop-color='#fff' stop-opacity='0.2' /><stop offset='45%' stop-color='#fff' stop-opacity='0.4' /><stop offset='55%' stop-color='#fff' stop-opacity='0.2' /><stop offset='100%' stop-color='black' stop-opacity='0.6' /></linearGradient></defs> ",y+=(x=C.strokeWidth,w=C.height-C.strokeWidth,p="",C.hasRoundRect&&(p=" rx='"+2*N+"' ry='"+2*N+"' "),"<rect name='housing' x='"+x+"' y='"+x+"'  width='"+(C.width-2*C.strokeWidth)+"' height='"+(C.height-2*C.strokeWidth)+"' "+p+" stroke='"+C.devBorderCol+"' stroke-width='"+1.3*C.strokeWidth+"' fill='"+C.devBordStartCol+"' /><line x1='"+2*N+"' y1='"+x+"' x2='"+(C.width-2*N)+"' y2='"+x+"' stroke='"+C.devBorderCol+"' stroke-width='"+C.strokeWidth+"' /><line x1='"+2*N+"' y1='"+w+"' x2='"+(C.width-2*N)+"' y2='"+w+"' stroke='"+C.devBorderCol+"' stroke-width='"+C.strokeWidth+"' />"),y+=(o="<rect ",o+=" name='brightness' x='"+(E-O)+"' y='"+(L-O/2)+"'  width='"+2*O+"' height='"+(k+O)+"'  rx='"+O/2+"' ry='"+O/3+"' opacity='0.4' fill='"+C.brightnessCol+"' />"),C.hasLabel&&(y+=(g=" ",b=1.2*N,v=(f=k/10-N/2)+N/2,B&&(g=" transform='rotate(-90 "+v+" "+v+") translate( -"+k+" , -"+2*C.strokeWidth+")' "),"<text name='housing'  x='"+b+"' y='"+v+"' fill='"+C.labelCol+"' "+g+" font-size='"+f+"' >"+C.label+"</text>")),y+=(i="<rect ",i+=" x='"+(E-A/2)+"' y='"+(L-C.strokeWidth/2)+"'  width='"+A+"' height='"+(k+C.strokeWidth)+"'  stroke='"+C.scaleBordCol+"' stroke-width='"+C.strokeWidth+"'  fill='none' /> "),C.hasEdgeCircle&&(y+=(m="<circle r='"+(u=.9*A)+"' cx='"+E+"' cy='"+(c=T+u)+"'  stroke='"+C.scaleBordCol+"' stroke-width='"+C.strokeWidth+"'  fill='"+C.scaleCol+"' />",C.hasGlass&&(m+="<circle r='"+(u-C.strokeWidth/2)+"' cx='"+E+"' cy='"+c+"'   fill='url(#"+C.id+"scale)' />"),m+="<rect  x='"+(E-A/2+C.strokeWidth/2)+"' y='"+T+"'  width='"+(A-C.strokeWidth)+"' height='"+1.3*C.strokeWidth+"'  fill='"+C.scaleCol+"' /> ")),y+=function(){for(var e,t=E+A/2+C.strokeWidth,r=E+A/2+C.width/7,n="",o=2*C.scaleDivideCount+1,i=M/2,a=0;a<o;a++)n+=" <line x1='"+t+"' y1='"+(e=L+a*i)+"'' x2='"+(r-a%2*O/3)+"' y2='"+e+"' stroke='"+C.strokeCol+"' stroke-width='"+C.strokeWidth+"' /> ";return n}(),C.hasScaleLabels&&(y+=function(){var e,t=0,r=E+A/2+C.width/7+.8*O;if(O<10)return"<text x='"+(e=r)+"' y='"+(T+7)+"' font-size='14' fill='"+C.strokeCol+"' >"+C.minValue+"</text> <text x='"+e+"' y='"+(L+4)+"' font-size='14' fill='"+C.strokeCol+"' >"+C.maxValue+"</text> ";for(var n=T+C.strokeWidth/2,o=(C.maxValue-C.minValue)/C.scaleDivideCount,i="' fill='"+C.textCol+"' font-style='plain'  text-anchor='middle'",a="",l=0;l<C.scaleDivideCount+1;l++){var s=Math.round(10*(C.minValue+o*l))/10;a+="<text name='housing'  x='"+r+"' y='"+(t=n-l*M)+"' "+i,B&&(a+=" transform='rotate(-90 "+r+" "+t+")' "),a+=0==s?" font-weight='bold' font-size='"+(O+2*C.strokeWidth)+"' >":" font-size='"+O+"' >",a+=s+"</text>"}return a}()),y+="<rect name='scale'  x='"+(E-A/2+C.strokeWidth/2)+"' y='"+(T-C.strokeWidth)+"'  width='"+(A-C.strokeWidth)+"' height='0' fill='"+C.scaleCol+"' />",C.hasGlass&&(y+=(h=E-A/2,d=C.hasRound?k+2.3*C.strokeWidth:k+1.5*C.strokeWidth,"<rect x='"+h+"' y='"+L+"' width='"+A+"' height='"+d+"' fill='url(#"+C.id+"scale)' />")),y+=(a=k/10-N/2,l=C.height-a-N/2-2*C.strokeWidth,s="<rect x='"+(3*C.width/4-1.2*a)+"' y='"+l+"'  width='"+2.15*a+"' height='"+a+"'  fill='"+C.devBordStartCol+"'  stroke='"+C.strokeCol+"'  stroke-width='"+C.strokeWidth+"' opacity='1' /><text  name='text'' x='"+(3*C.width/4-C.strokeWidth)+"' y='"+(C.height-N-C.strokeWidth)+"' text-anchor='middle' fill='"+C.textCol+"' font-size='"+a+"' >?</text>",s+="<rect name='valuesPane' x='"+(3*C.width/4-1.1*a)+"' y='"+(l+C.strokeWidth)+"'  width='"+2*a+"' height='"+(a-2*C.strokeWidth)+"'  fill='"+C.devBordStartCol+"' opacity='0.1' />"),I.innerHTML=y+"</g>",function(){for(var e,t=I.childNodes[0],r="",n=0;n<t.childNodes.length;n++){e=t.childNodes[n];try{e instanceof Text||!e.hasAttribute("name")||("scale"==(r=e.getAttribute("name"))&&(W=e),"brightness"==r&&(e.addEventListener("click",H),S=e),"text"==r&&(D=e),"valuesPane"==r&&e.addEventListener("click",P),"housing"==r&&e.addEventListener("click",H))}catch(e){}}}(),!0}var u=!1;return function(){var e;if(r=C.brightnessCol,C.width%5!=0){for(e=Math.round(C.width);e%6!=0;)e++;C.width=e}if(!function(){var e=!0;if(C.hasOwnProperty("scaleWidth")){var t=C.scaleWidth;(t!=t||91<Math.abs(t-100))&&(e=!1)}if(C.hasOwnProperty("fontSize")&&(O!=O||O<8||100<O))return!1;if((C.height!=C.height||C.height<10||C.width!=C.width||C.width<10||C.strokeWidth!=C.strokeWidth||C.strokeWidth<1||C.maxValue!=C.maxValue||C.minValue!=C.minValue||C.scaleDivideCount!=C.scaleDivideCount||C.scaleDivideCount<1)&&(e=!1),!e)throw console.log("ERROR : wrong start parameter"),new Error("Illegal value og parameter");return e}())throw u=!0,new Error("init param wrong");if(C.height<=C.width){var t=C.width;C.width=C.height,C.height=t,B=!0}i(!1),h(C.owner),u=!1}(),u?null:{setValue:e,brightness:function(e){return null!=S&&(S.setAttribute("fill",e),C.brightnessCol=e,!0)},getBrightness:r,showValue:t}}(h)),l.hasOwnProperty("oval")&&(!function(){var e=l.oval;for(var t in i)e.hasOwnProperty(t)?h[t]=e[t]:h[t]=i[t];e.hasOwnProperty("fontSize")&&(i.fontSize=e.fontSize),e.hasOwnProperty("hasRound")&&0==e.hasRound&&(h.width=Math.round(h.width+h.width/10))}(),d=function(p){var e,y,C=40,A=null,k=null,M=null,T=void 0,r=!1,n=0,L=!1,E=0;function t(e){o((L=e)?E:"?")}function o(e){return null!=M&&(M.textContent=e,!0)}function N(){r?r&&(f.parentNode.removeChild(f),m.innerHTML="",p.width=n,y=c,i(p.owner),r=!1):function(){if(!r){g.appendChild(f),c=y,n=p.width;var e=document.body.clientHeight,t=document.body.clientWidth;p.width=e<t?Math.round(.85*e):Math.round(.85*t),y=y*p.width/n,T.innerHTML="<svg  width='"+p.width+"' height='"+p.width+"' viewBox='0,0 "+p.width+" "+p.width+"' xmlns='http://www.w3.org/2000/svg'></svg>",m.setAttribute("style","padding-top:"+(e-p.width)/2+"px; height: "+p.width+"px;"),i(m),r=!0}}()}function B(){t(!L)}function i(e){var t=p.hasRound?p.width:.9*p.width;e.innerHTML="<svg  width='"+p.width+"' height='"+t+"' viewBox='0,0 "+p.width+" "+p.width+"' xmlns='http://www.w3.org/2000/svg'></svg>",(T=e.getElementsByTagName("svg")[0]).innerHTML="";var r,n,o,i,a,l,s,d,h,u,c,m,f,g,b,v,x,w=function(){p.gradId=p.brightnessId+"Cgrad";var e="<defs> <radialGradient id='"+p.gradId+"' cx='50%' y='30%'> ";return e+=" <stop name='brightness' offset='5%' stop-color='"+p.brightnessCol+"' /> <stop offset='25%' stop-color='"+p.brightnessCol+"'  /> <stop offset='45%' stop-color='"+p.fill+"' /> <stop offset='93%' stop-color='"+p.fill+"' /> <stop offset='98%' stop-color='"+p.devBordStartCol+"' /> </radialGradient> </defs> <defs><radialGradient id='"+p.gradId+"1' cx='50%' y='50%'> ",e+=" <stop offset='80%' stop-color='"+p.devBordStartCol+"'/>",e+="  <stop offset='90%' stop-color='"+p.devBordStopCol+"'  />",e+="  <stop offset='93%' stop-color='"+p.devBordStopCol+"'  />",e+=" <stop offset='98%' stop-color='"+p.devBordStartCol+"' />",e+=" <stop offset='100%' stop-color='"+p.devBordStartCol+"'  />",e+="</radialGradient> </defs>"}()+(r="<ellipse name='flip' ",n=p.width/2-p.strokeWidth,o=p.hasRound?n:.43*p.width,r+=" cx='"+p.width/2+"' cy='"+p.width/2+"'  rx='"+n+"' ry='"+o+"' stroke='"+p.devBorderCol+"' stroke-width='"+2*p.strokeWidth+"'  fill='url(#"+p.gradId+"1)' /> <ellipse cx='"+p.width/2+"' cy='"+p.width/2+"'  rx='"+n+"' ry='"+o+"' stroke='"+p.devBorderCol+"' stroke-width='"+2*p.strokeWidth+"'  fill='none' /> ");w+=function(e,t,r,n,o,i){(e!=e||e<1||50<e)&&(50<e&&(e=50),e<1&&(e=1),console.log('WARNING gigro: "radius oval`s must be digits in percents (from 1 to 50)" '));var a="<circle  name='flip' ";null==t&&(t=p.strokeCol),null==r&&(r=p.strokeWidth),null==n&&(n="none"),null==o&&(o=p.width/2),null==i&&(i=p.width/2);for(var l=[Math.round(p.width*e/100)-r,o,i,t,r,n],s=0;s<6;s++)a+=O[s]+l[s];return a+="' /> "}(C,void 0,2*p.strokeWidth,"url(#"+p.gradId+")"),w+=function(){for(var e="",t=(p.stopAngle-p.startAngle)/p.scaleDivideCount,r=p.width/2+2*p.strokeWidth-Math.round(C*p.width/100),n=r+Math.round(C*p.width/650),o=p.width/2,i=400<p.width?4*p.strokeWidth:5*p.strokeWidth/3,a=0;a<=p.scaleDivideCount;a++)e+=I(!0,r,o,n,o,p.startAngle+a*t,p.strokeCol,i);if(10<t){n=r+(n-r)/2,t/=5,i/=2;var l=5*p.scaleDivideCount+1;for(a=0;a<l;a++)e+=I(!0,r,o,n,o,p.startAngle+a*t,p.strokeCol,i)}return e}(),w+=function(){for(var e,t,r=(p.stopAngle-p.startAngle)/p.scaleDivideCount,n=C*p.width/150,o=S?y/2.4:y/2,i=" ",a=p.scaleDivideCount+1,l=0,s=80<C*p.width/100,d=14<p.scaleDivideCount,h=0;h<a;h++){var u=Math.PI/180*(p.startAngle+h*r);if(0!=h&&h!=p.scaleDivideCount||(l=o/4),0==h||h==p.scaleDivideCount||s){if(d&&h%2!=0)continue;e=Math.round(p.width/2-n*Math.cos(Math.PI/180+u)),t=Math.round(p.width/2-n*Math.sin(Math.PI/180+u)),i+="<text name='flip' text-anchor='middle' font-size='"+(o+l)+"' ",i+=" fill='"+p.textCol+"' x='"+e+"' y='"+t+"' >",i+=p.minValue+h*Math.round((p.maxValue-p.minValue)/p.scaleDivideCount)+"</text>"}}return i}(),w+=(i=S?"50%":"0%",a=S?y/1.42:y/1.3,l=p.width*C/220,s=p.width/2,d=4*p.width/7,"<defs> <path  id='"+p.id+"labelPath'  d='M "+(s-l+y/6)+", "+(d+y/5)+" C "+(s-l+y/2)+", "+d/2+" "+(s+l-y/2)+", "+d/2+" "+(s+l-y/4)+", "+d+"' /> </defs><text  x='"+(s-l-y/6)+"' y='0%'  font-size='"+a+"' fill='"+p.labelCol+"'  text-anchor='middle' > <textPath xlink:href='#"+p.id+"labelPath' startOffset='"+i+"' >"+p.label+"</textPath></text> "),w+=(h=L?E:"?",u=1.4*y,c=Math.round(u/4),m=Math.round(p.width*(.5+3*C/400)),f="<rect x='"+(p.width/2-1.1*u)+"' y='"+(m-3.2*c)+"'  width='"+2.2*u+"' height='"+(u-.2*c)+"'  stroke='"+p.devBorderCol+"' stroke-width='"+c/5+"'  fill='"+p.devBordStartCol+"' />",f+="<text x='"+p.width/2+"' y='"+m+"'  name='text' text-anchor='middle' opacity='0.8'  font-size='"+u+"' fill='"+p.textCol+"' >"+h+"</text> ",f+="<rect name='valuesPane' x='"+(p.width/2-1.15*u)+"' y='"+(m-3.25*c)+"'  width='"+2.1*u+"' height='"+(u-.3*c)+"'  fill='"+p.devBordStartCol+"' opacity='0.1' />"),w+=(g=p.width/2,b=p.width/2,v=400<p.width?C/3:C/6,x="<polygon name='arrow' ",x+=" points='"+(g+2*v)+","+b+" "+(g+3*v)+","+(b+v)+" ",x+=g-Math.round(C*p.width/110)+","+b+" "+(g+3*v)+","+(b-v)+"' ",x+=" stroke='"+p.arrStrokeCol+"' stroke-width='"+2*p.strokeWidth/3+"' ",x+=" transform='rotate("+p.alpha+" "+g+" "+b+")' fill='"+p.arrFillCol+"' /> ",x+="<circle r='"+v/4+"' cx='"+g+"' cy='"+b+"' fill='black' />"),T.innerHTML=w,function(){for(var e=T.getElementsByTagNameNS("http://www.w3.org/2000/svg","stop"),t=0;t<e.length;t++)e[t].hasAttribute("name")&&"brightness"==e[t].getAttribute("name")&&(A=e[t]);A.addEventListener("click",N);var r,n="";for(t=0;t<T.childNodes.length;t++){r=T.childNodes[t];try{!(r instanceof Text)&&r instanceof Node&&r.hasAttribute("name")&&("arrow"==(n=r.getAttribute("name"))&&(k=r),"text"==n&&(M=r),"flip"==n&&r.addEventListener("click",N),"valuesPane"==n&&r.addEventListener("click",B))}catch(e){console.log(e)}}}()}var O=[" r='","' cx='","' cy='","', stroke='","' stroke-width='","' fill='"];function I(e,t,r,n,o,i,a,l){null==a&&(a=p.strokeCol),null==l&&(l=p.strokeWidth);var s="<line ";return null==n&&(n=p.width/2),null==o&&(o=p.width/2),s+="x1='"+t+"' y1='"+r+"' x2='"+n+"' y2='"+o+"' ",s+=" stroke='"+a+"' stroke-width='"+l+"' ",null!=i&&0!=i&&(s+=" transform='rotate("+i,s+=e?", "+p.width/2+", "+p.width/2+")' ":")' "),s+=" /> "}var a=!1;return function(){p.owner.innerHTML="",e=p.brightnessCol;try{p.width=Math.round(p.width),p.width%2!=0&&p.width++,n=p.width,a=function(){if(p.hasOwnProperty("fontSize")){var e=l.fontSize;if(e!=e||e<8||100<e)return console.log("ERROR Illegal start parameter fontSize it must be from 8 to 100"),!1;y=e}else(y=Math.round(p.width*C/340))<8&&(y=8);return!0}(),p.id=s,p.brightnessId=s+"brigID",i(p.owner)}catch(e){throw console.log("measurer.js - ERROR on start device: "+e.toString()),console.log("ON START DEVICE I have parameters:"),a=!1,e}}(),a?{flip:N,setValue:function(e){if(null==k)return!1;if(e!=e||e<p.minValue||e>p.maxValue)return console.log("WARNING out of bounds leave: ("+p.maxValue+" - "+p.minValue+")  i get: "+e),o(E="ERR"),!1;p.alpha=p.stopAngle-(p.stopAngle-p.startAngle)*(p.maxValue-e)/(p.maxValue-p.minValue);var t="rotate("+p.alpha+" "+p.width/2+" "+p.width/2+")";return k.setAttribute("transform",t),E=e,L&&o(E),!0},brightness:function(e){return null!=A&&(A.setAttribute("stop-color",e),p.brightnessCol=e,!0)},getBrightness:e,showValue:t}:null}(h))}return d}function Plotter(e,g,b,t){if(null==e&&!(e instanceof HTMLElement))return console.log("'painter' parameter must be HTML container. I get: "+e),null;if(g!=g||b!=b||g<40||b<40)return console.log("plotter.js:  WARNING wrong width or height parameters"),null;var v,x,w,p,y,C,k={borderCol:"#623",bgCol:"#faf9e5",axisCol:"#541",labelCol:"#255"},r=e,M=Math.round(b/100),T=Math.round(b/250);T<1&&(T=1);var A,L,E,N=!1,B="#776",O=T,I=!1,S={},D=Math.round(b/25),W="",H="";function P(e,t,r){if(!t||!(t instanceof Array)&&!t.hasOwnProperty("values")||t.length<1)return console.log("plotter.js buildGraph [wrong parameter:second parameter must be array with numerical values or object with values and labels(see plotter.js function buildGraph]"),!1;if("string"!=typeof e)return console.log("buildGraph [wrong parameter: first parameter must be string values"),!1;if(A=e,t instanceof Array)L=t,I=!1;else{if(!(t.values instanceof Array&&0<t.values.length))return console.log('(plotter.js)Error First member object toDraw must have name "values" and contains array of numerical values'),!1;L=t.values,I=!!(t.hasOwnProperty("xAxisLabels")&&t.xAxisLabels instanceof Array&&t.xAxisLabels.length==t.values.length)&&t.xAxisLabels}!function(e){var t={};e&&e.hasOwnProperty("min")&&e.hasOwnProperty("max")?(t.min=e.min,t.max=e.max):(t.min=L[0],t.max=L[0],L.forEach(function(e){return e!=e?(console.log("array for chart contains not numbers:"+e),!1):(t.min>e&&(t.min=e),t.max<e&&(t.max=e),!0)}),t.min==t.max&&(0==t.min?(t.max=10,t.min=-10):(t.max=0<t.max?2*t.max:t.min,t.min=t.min<0?2*t.min:t.min)));S.min=t.min,S.max=t.max}(r);var n,o,i,a,l,s,d,h,u,c,m=function(){var e,t={},r=Math.abs(S.min-S.max),n=0,o=0,i=(r=4<r&&r<10.1?11:r)<10?-1:1;for(;!((e=r/Math.pow(10,i*n))<101&&10<e);)n++;if(n*=i,t.pow=n,(e=Math.round(e)+1)<=31)o=e,e=Math.pow(10,n);else if(e<=61){for(;e%2!=0;)e++;o=e/2,e=2*Math.pow(10,n)}else if(e<91){for(;e%3!=0;)e++;o=e/3,e=3*Math.pow(10,n)}else o=25,e=4*Math.pow(10,n);return t.count=o,t.vOd=e,t.ySpace=(w-y)/(o+2),function(e){var t=0;if(S.max<0){for(;S.max+e.vOd*t<0;)t++;e.startDash=e.count+t-1,e.xAxisPos=w-(e.count+1)*e.ySpace}else if(0<S.min){for(;0<S.min+t*e.vOd;)t--;e.startDash=t+1,e.xAxisPos=w}else if(0<=S.max&&S.min<=0){for(;S.min+e.vOd*t<0;)t++;e.startDash=t,e.xAxisPos=w-t*e.ySpace}}(t),t}(),f=(p-x-3*M)/(L.length+1);return n=L.length,o=f,i=m,v.innerHTML="",V(),u=x+","+(w+M)+" "+x+","+(y+C)+" "+(x-M)+","+(y+C)+" "+x+","+y+" "+(x+M)+","+(y+C)+" "+x+","+(y+C),v.innerHTML+="<polyline  points='"+u+"' stroke='"+k.axisCol+"'  stroke-width='"+T+"'  />",d=i.xAxisPos,h=x-M+","+d+" "+(p-C)+","+d+" "+(p-C)+","+(d-M)+" "+p+","+d+" "+(p-C)+","+(d+M)+" "+(p-C)+","+d,v.innerHTML+="<polyline points='"+h+"' stroke='"+k.axisCol+"' ' stroke-width='"+T+"' />",function(e){if(!(b<260)){var t,r="",n=x+D/3,o=e.count+2,i=e.startDash;o<i?(i=o,R(Math.round(e.xAxisPos+e.ySpace/2)),z(e,(1-e.startDash)*e.vOd,1)):i<0?(i=0,R(Math.round(e.xAxisPos-e.ySpace/2)),z(e,(1-e.startDash)*e.vOd,1)):z(e,0,e.startDash);for(var a=0;a<o;a++)t=e.xAxisPos-(a-i)*e.ySpace,r+="<line x1='"+x+"' y1='"+t+"' x2='"+n+"'  y2='"+t+"'  stroke-width='"+T/2+"' stroke='"+k.axisCol+"'  fill='black' />",r+="<line x1='"+x+"' y1='"+t+"' x2='"+p+"' y2='"+t+"'  stroke-width='"+T/5+"' stroke='#ccc'  fill='#fff' />";v.innerHTML+=r}}(i),a=i.xAxisPos,l="<text  x ='"+(x+2*M)+"' y='"+(y+C)+"'  font-size='"+D+"' text-anchor='start'  fill='"+k.labelCol+"' >"+H+"</text>",s="<text  x='"+(g-C)+"' y='"+(a+(2*D<b-a?1.5*D:-.2*D))+"' ' text-anchor='end' fill='"+k.labelCol+"'  font-size='"+D+"' >"+W+"</text>",v.innerHTML+=s+l,function(e,t,r){for(var n,o="",i=r<=y?r+D/3:r-D/3,a=w-2*M,l=y+2*M,s=1;s<e;s++)o+="<line x1='"+(n=x+s*t)+"' y1='"+r+"'  x2='"+n+"' y2='"+i+"'  stroke='"+k.axisCol+"' stroke-width='"+T/2+"' /> ",o+="<line x1='"+n+"' y1='"+a+"'  x2='"+n+"' y2='"+l+"'  stroke='#ccc' stroke-width='"+T/5+"' /> ";I&&function(e,t){var r=I.length,n=D-M;n<10&&(n=D);var o=w<t+n?t-D/3:t+1.2*n,i=1;20<r?i=3:10<r&&(i=2);for(var a,l='<text x="'+x+'" y="'+o+'"  font-size="'+n+'"  fill="'+k.labelCol+'" >'+I[0]+"</text>",s=1;s<r;s++)a=x+s*e,s%i==0&&(l+='<text x="'+a+'" y="'+o+'"  font-size="'+n+'" text-anchor="middle" fill="'+k.labelCol+'" >'+I[s]+"</text>");v.innerHTML+=l}(t,r),v.innerHTML+=o}(n,o,i.xAxisPos),c=A,v.innerHTML+="<text x='"+g/2+"' + y='"+1.2*D+"'  font-size='"+D+"' text-anchor='middle' fill='"+k.labelCol+"' style='font-style:italic;text-decoration:underline;' ' >"+c+"</text>",function(e,t,r){var n,o,i,a=" fill='"+k.bgCol+"' stroke='"+B+"' stroke-width='"+O+"' />",l=1.2*T,s=r.ySpace,d=w-r.startDash*s,h=s/r.vOd,u=x,c="<g name='chart'>",m=1;20<e.length?m=4:15<e.length?m=3:10<e.length&&(m=2);for(i=1;i<e.length;i++)G(e[i-1],e[i])&&(n=d-h*e[i-1],o=d-h*e[i],c+="<line x1='"+u+"' y1='"+n+"' x2='"+(u+t)+"' y2='"+o+"' "+a,N&&i%m==0&&(c+="<circle cx='"+u+"' cy='"+n+"' r='"+l+"' "+a,c+="<text x='"+u+"' y='"+(n-4*T)+"' text-anchor='middle'  fill='black' font-size='"+D+"' >"+e[i-1]+"</text>")),u+=t;e.length<2&&(o=d-h*e[0]);c+="<circle cx='"+u+"' cy='"+o+"' r='"+l+"' "+a,N&&(c+="<text x='"+u+"' y='"+(o-4*T)+"' text-anchor='middle'  fill='black' font-size='"+D+"' >"+e[i-1]+"</text>");c+="</g>",v.innerHTML+=c}(L,f,m),function(){var e=N?"-":"+";v.innerHTML+='<text x="'+(p-D/2)+'" y="'+(.9*D+M)+'"  font-size="'+(D+2*T)+'" font-weight="bold" text-anchor="middle" fill="#065" >'+e+'</text><rect name="toggle" x="'+(p-D)+'" y="'+M+'" width="'+D+'" height="'+D+'" fill="white" opacity="0.5" stroke="'+k.borderCol+'"  stroke-width="'+T/3+'" />';for(var t=0;t<v.childNodes.length;t++){var r=v.childNodes[t];r instanceof Text||!r.hasAttribute("name")||"toggle"!=r.getAttribute("name")||(r.onclick=function(){return N=!N,P(A,{values:L,xAxisLabels:I},S),0})}}(),!0}function V(){v.innerHTML="<rect name='border' x='"+(M-2)+"' y='"+(M-2)+"'   rx='"+4*T+"' ry='"+4*T+"'  height='"+(b+4)+"' width='"+(g+4)+"' stroke='"+k.borderCol+"' stroke-width='"+T+"' fill='"+k.bgCol+"' />"}function R(e){var t,r=C,n=1.4*C;for(t='<path d="';r<p;)t+="M"+r+","+e+" L"+(r+n)+","+e+" ",r+=2*C;t+='" stroke="#ec0" stroke-width="'+2*T+'" />',v.innerHTML+=t}function d(e){return"string"==typeof e&&4<e.length?x+2.5*D:x-3*T}function z(e,t,r){var n=h(e,t+e.vOd),o=h(e,(e.count-e.startDash)*e.vOd);t=h(e,t);var i=w-e.ySpace*r+D/3,a=w-e.ySpace*e.count+D/3,l=' fill="'+k.labelCol+'" font-size="'+D+'" text-anchor="end" ',s='<text x="'+d(t)+'" y="'+i+'" '+l+" >"+t+'</text><text x="'+d(n)+'" y="'+(i-e.ySpace)+'" '+l+" >"+n+"</text>";v.innerHTML+=s,s='<text x="'+d(o)+'" y="'+a+'" '+l+" >"+o+"</text>",v.innerHTML+=s}function h(e,t){return 0==t||Math.abs(t)<1e-7?0:Math.abs(t)<.1?(t=Math.round(1e3*t),console.log("rounded number="+t),t/100+"*E-2"):.1<Math.abs(t)&&Math.abs(t)<1e3||0==t?(Math.round(t)!=t&&(t=Math.round(100*t)/100),t+""):(t=(t=t/Math.pow(10,e.pow)+"").length<3?t+=".0":t.substring(0,2))+"*E"+e.pow}function G(e,t){return!(e<S.min||e>S.max)&&!(t<S.min||t>S.max)}function n(e){E&&(E.innerHTML="",e.innerHTML="")}return function(){for(var e in k)t&&t.hasOwnProperty(e)&&(k[e]=t[e]);r.width=g,r.height=b,r.innerHTML="<svg  width='"+g+"' height='"+b+"' viewBox='0,0 "+g+" "+b+"' xmlns='http://www.w3.org/2000/svg'></svg>",b-=2*M,g-=2*M,v=r.getElementsByTagName("svg")[0],x=4*M+1.3*D,C=3*M,w=b-2*M,p=g-2*M,y=2*M,D<10&&(!0,D=12),V()}(),{setAxisLabels:function(e,t){W=e,H=t},create:P,hasVisibleValues:function(e){N=e},chartColor:function(e){B=e},simpleChart:function(e,c){if(c.max&&c.min&&!(0<e.getElementsByTagName("svg").length)){var m,s,d,f,g,b,h=e.width-3*M,u=e.height-3*M,v=u-5*M,x=D+2*M,w=h-4*M,p=w/6;for(m in e.innerHTML="<svg  width='"+h+"' height='"+u+"' viewBox='0,0 "+h+" "+u+"' xmlns='http://www.w3.org/2000/svg'></svg>",(E=e.getElementsByTagName("svg")[0]).setAttribute("style","cursor:pointer"),E.onclick=function(){n(e),e.setAttribute("class","noSize")},function(){for(var e in m=1,s=c.min,d=c.max,b=0,g=x+(f=v/(d-s))*d,E.innerHTML+='<rect x="10" y="10" rx="'+5*T+'" ry="'+5*T+'" width="'+(h-20)+'" height="'+(u-20)+'" fill="'+k.bgCol+'" stroke="'+k.borderCol+'" stroke-width="'+T+'" />',c)"min"!=e&&"max"!=e&&(0==b&&0<c[e].points.length&&(b=(w-p)/c[e].points.length),t=c[e].name,r=c[e].color,n=M+m*D,E.innerHTML+='<text x="'+3*M+'" y="'+n+'" fill="'+r+'"  font-size="'+D+'" >'+t+"</text>",m++);var t,r,n,o,i,a,l;0<d&&s<0&&(o=p,i=w,a=g,l=D,E.innerHTML+='<text x="'+(o-M)+'" y="'+(a+l/2)+'"  stroke="'+k.axisCol+'" stroke-width="'+2*T/3+'"  font-size="'+2*l/3+'" text-anchor="end" >0</text>',E.innerHTML+='<line x1="'+o+'" y1="'+a+'" x2="'+i+'"  y2="'+a+'" stroke="'+k.axisCol+'" stroke-width="'+T/2+'" />')}(),c)"min"!=m&&"max"!=m&&t(c[m].points);var y=!1}function t(e){e instanceof Array&&0<e.length&&("number"==typeof e[0]?function(e){for(var t=e[0],r=e[0],n='<polyline points="',o=0;o<e.length;o++)e[o]>r&&(r=e[o]),e[o]<t&&(t=e[o]),n+=p+o*b+","+(g-f*e[o])+" ";n+='" fill="none" stroke="'+c[m].color+'"  stroke-width="'+T+'" />',r=Math.round(r),t=Math.round(t),C(r,t,g-f*r,g-f*t,c[m].color),E.innerHTML+=n}(e):function(e){for(var t,r,n,o,i=Math.round(2*D/3),a=e[0].val,l=e[0].val,s='<polyline points="',d=[],h=0;h<e.length;h++)if(o=e[h].val,a<o&&(a=o),o<l&&(l=o),s+=(r=p+h*b)+","+(n=g-f*o)+" ",e[h].svg&&(n<60&&(n=60),v-60<n&&(n=v-60),(t=e[h].svg).setAttribute("x",r-t.getAttribute("width")/3),t.setAttribute("y",n-t.getAttribute("height")+4),d[h]=t),e[h].text){var u=e[h].text.split(/\n/);E.innerHTML+='<line x1="'+r+'" y1 ="'+x+'"  x2="'+r+'" y2="'+(v-u.length*i)+'" stroke="'+k.axisCol+'"  stroke-width="'+T/3+'" />',1==u.length?E.innerHTML+='<text x="'+r+'" y="'+v+'"  font-size="'+i+'" text-anchor="middle"  stroke="'+k.labelCol+'" stroke-width="1" >'+e[h].text+"</text>":A(r,u,i)}for(h in s+='" fill="none" stroke="'+c[m].color+'"  stroke-width="'+T+'" />',E.innerHTML+=s,a=Math.round(a),l=Math.round(l),C(a,l,g-f*a,g-f*l,c[m].color),d)E.appendChild(d[h])}(e))}function C(e,t,r,n,o){var i="",a=y?w:w-D;y=!y;var l='stroke="'+o+'"  stroke-width="'+T/2+'" ',s='font-size="'+2*D/3+'" text-anchor="end" ';i+='<line x1="'+p+'" y1="'+n+'" x2="'+w+'" y2="'+n+'" '+l+" />",i+='<text x="'+a+'" y="'+(n-2)+'" '+l+s+">"+t+"</text>",i+='<line x1="'+p+'" y1="'+r+'" x2="'+w+'" y2="'+r+'" '+l+" />",i+='<text x="'+a+'" y="'+(r+2*D/3)+'" '+l+s+">"+e+"</text>",E.innerHTML+=i}function A(e,t,r){for(var n=v-(t.length-1)*r+2*T,o=0;o<t.length;o++)E.innerHTML+='<text x="'+e+'" y="'+(n+o*r)+'" font-size="'+r+'" text-anchor="middle" stroke="'+k.labelCol+'" stroke-width="1" >'+t[o]+"</text>"}},clearSimpleChart:n}}function MeteoViewer(){var i,r,n,o,a,l,u=function(e,t){return e.length<3?"":(e=e.trim().substring(0,3).toLowerCase(),t?shortWord[e]:word[e])},c=[],s="http://www.w3.org/2000/svg";function m(){if(!(c.length<2||document.body.clientWidth<document.body.clientHeight)){var e=function(e){for(var t=[],r=[],n={},o=e[0].max,i=e[0].min,a=0;a<e.length;a++){e[a].max>o&&(o=e[a].max),e[a].min<i&&(i=e[a].min);var l=document.createElementNS(s,"image");l.setAttribute("width","52"),l.setAttribute("height","52"),l.setAttributeNS(s,"xlink:href",e[a].picture),t[a]=e[a].min,r[a]={val:e[a].max,svg:l,text:e[a].date}}return n.min=Math.round(i-(o-i)/5),n.max=Math.round(o+(o-i)/10),n.label={name:"&nbsp; &nbsp;"+word.forecast,color:"#752",points:[]},n.space0={name:"",color:"rgba(0,0,0,0)",points:[]},n.maxThemp={name:word.day+" t℃",color:"#909",points:r},n.space1={name:"",color:"rgba(0,0,0,0)",points:[]},n.minThemp={name:word.night+" t℃",color:"#069",points:t},n}(c);null==l&&(l=document.createElement("div")),l.setAttribute("class","bigSize");var t=document.createElement("div");t.width=4*document.body.scrollWidth/5,t.height=5*document.body.scrollHeight/6,t.setAttribute("style","margin-top:"+document.body.scrollHeight/12+"px"),l.appendChild(t),document.body.appendChild(l),i.simpleChart(t,e),l.onclick=function(){i.clearSimpleChart(t),l.setAttribute("class","noSize")}}}return{createDevPanel:function(){var e={devBordStartCol:"rgba(75,95,130,0.3)"},t={label:"&nbsp;t℃"};return r=new Measurer(document.getElementsByName("inThermOwner")[0],{colors:e,bounds:{minValue:0,maxValue:40,scaleDeviceCount:20},rect:t}),n=new Measurer(document.getElementsByName("outThermOwner")[0],{colors:e,bounds:{minValue:-50,maxValue:50,scaleDeviceCount:30},rect:t}),e={devBordStopCol:"rgba(80,90,10,0.2"},o=new Measurer(document.getElementsByName("baroOwner")[0],{bounds:{minValue:650,maxValue:810,scaleDivideCount:16},oval:{label:"&nbsp;"+word["baro.label"],startAngle:-35,stopAngle:215,hasRound:!1},colors:e}),a=new Measurer(document.getElementsByName("hygroOwner")[0],{bounds:{minValue:0,maxValue:100,scaleDeviceCount:10},oval:{startAngle:-10,stopAngle:190,label:"&nbsp;%",hasRound:!1},colors:e}),{indoorTherm:r,outdoorTherm:n,barometer:o,hygrometer:a}},createActivityPanel:function(e){if(document.body.clientWidth<document.body.clientHeight)return null;if(!(e instanceof HTMLElement))return console.log("ERROR can`t create activity panel: I get not HTMLElement:"+e),null;var t,r=["   ","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=[word.all,word.jan,word.feb,word.mar,word.apr,word.may,word.jun,word.jul,word.aug,word.sep,word.oct,word.nov,word.dec],o=document.forms.checkDuration,i=o.getElementsByTagName("label"),a=function(){for(h.setAttribute("disabled","disabled"),u.setAttribute("disabled","disabled"),c.setAttribute("disabled","disabled"),t=0;t<i.length;t++)i[t].setAttribute("class","label")},l=o.elements.sensorSelect,s={empty:"",tOut:word["tOut.text"],tIn:word["tIn.text"],baro:word["baro.text"],humid:word["humid.text"]};for(t in s)l.appendChild(new Option(s[t],t));var d=o.elements.intervalSelect;d.appendChild(new Option("  ","empty")),d.appendChild(new Option("  "+word.lastHour+" ","lastHour")),d.appendChild(new Option(word.checkInterval,"checkInterval")),d.setAttribute("disabled","disabled");var h=o.elements.yearSelect;for(h.appendChild(new Option("?","empty")),t=2018;t<2026;t++)h.appendChild(new Option(t,t+""));for(t=0;t<h.getElementsByTagName("option").length;t++)h.getElementsByTagName("option")[t].setAttribute("style","color:");h.setAttribute("disabled","disabled");var u=o.elements.monthSelect;for(t=0;t<r.length;t++)u.appendChild(new Option(n[t],r[t]));u.setAttribute("disabled","disabled");var c=o.elements.daySelect;for(c.appendChild(new Option(word.all," ")),t=1;t<32;t++)c.appendChild(new Option(t+"",t));c.setAttribute("disabled","disabled");var m=o.elements.submitButton;return m.setAttribute("value","getChart"),m.setAttribute("disabled","disabled"),m.setAttribute("class","submitButton"),m.innerHTML=word.build,a(),o.addEventListener("click",function(e){0==l.selectedIndex&&(d.setAttribute("disabled","disabled"),a()),0<l.selectedIndex&&d.hasAttribute("disabled")&&d.removeAttribute("disabled"),0<l.selectedIndex&&1==d.selectedIndex&&a()},!1),o},createChart:function(e){if(document.body.clientWidth<document.body.clientHeight)return null;var t=document.body.clientWidth-1.1*document.getElementsByTagName("aside")[0].offsetWidth,r=getComputedStyle(document.getElementsByTagName("aside")[0]).padding;r=r.substring(0,r.length-2);var n=document.getElementsByName("informer")[0].clientHeight,o=document.getElementsByTagName("aside")[0].clientHeight-Math.max(document.getElementsByName("activityPanel")[0].offsetHeight,n)-4*r;return i=new Plotter(e,t,o,{borderCol:getComputedStyle(document.getElementsByTagName("table")[0]).borderColor})},createInformer:function(e,t){var r;(r=document.createElement("div")).setAttribute("class","inlineTop informerFore"),r.onclick=m,r.innerHTML=word.forecastButtonName,e.appendChild(r);var s=document.createElement("div");s.setAttribute("class","informerBoard inlineTop wavesBackGround");var d,h=t.query.results.channel;!function(e){var t=document.createElement("a");t.setAttribute("href",e.link),t.setAttribute("target","_blank"),t.setAttribute("style","text-align:center");var r=document.createElement("img");r.setAttribute("src",e.url),r.setAttribute("width",e.width),r.setAttribute("height",e.height),r.setAttribute("alt",e.title),r.setAttribute("class","informerImgBord logo right"),t.appendChild(r),s.appendChild(t)}(h.image),function(e,t){var r=(new Date).getHours(),n=(new Date).getMinutes()/100;r+=n;var o=h.astronomy.sunrise+"";o=1*(o=o.substring(0,o.indexOf(" ")).replace(":","."));var i=h.astronomy.sunset+"";i=12+1*(i=i.substring(0,i.indexOf(" ")).replace(":","."));var a=o<r&&r<i?"left imgDay informerImgBord":"left imgNight informerImgBord",l=e.substring(9,e.indexOf(">")+1);(d=document.createElement("div")).setAttribute("class",a),d.innerHTML=l,s.appendChild(d)}(h.item.description);var n=h.atmosphere,o=h.item.forecast;function i(e,t){var r=t?"\n":"&nbsp;",n=u(e.split(" ")[1],t);return!t&&-1<navigator.language.search("ru")&&(n=0<n.indexOf("ь")||0<n.indexOf("й")?n.substring(0,n.length-1)+"я":n+"а"),e.split(" ")[0]+r+n}return function(e,t){var r=t.date;r=u(t.day,!0)+"&nbsp;"+i(r,!1);var n=document.createElement("div");n.setAttribute("class","informerText");var o='<div><span class="informer labelColor"> '+r+'</span></div><span  class="informer labelColor">'+word["humid.label"]+" "+e.humidity+'&nbsp;%</span><br /><span  class="informer labelColor">'+word.pressure+"&nbsp;"+(e.pressure/1e3*750.0637+"").substring(0,3)+"&nbsp;"+word["baro.label"]+'</span><div style="margin-top: 0.3em;margin-bottom: 3px">&nbsp;<span  class="informerDay">'+word.day+": "+(5*(t.high-32)/9+"").substring(0,4)+' ℃ </span>&nbsp;<span class="informerNight">'+word.night+": "+(5*(t.low-32)/9+"").substring(0,4)+" ℃ &nbsp;</span></div>";n.innerHTML+=o,s.appendChild(n)}(n,o[0]),function(e){for(var t=0;t<e.length;t++){var r={};r.picture="http://l.yimg.com/a/i/us/we/52/"+e[t].code+".gif",r.max=Math.round(500*(e[t].high-32)/9)/100,r.min=Math.round(500*(e[t].low-32)/9)/100,r.date=u(e[t].day,!0)+" "+i(e[t].date,!0),c[t]=r}}(o),e.appendChild(s),{end:"yes"}},showForecast:m}}window.debug||(debug=!1);var chartBoard,serverRoot="http://"+window.location.host+"/";console.log("debug="+debug),debug&&console.log(" start test execution ON host:"+serverRoot),debug&&console.log("Browser: '"+navigator.userAgent+"'  "),function(){var e,t=new MeteoViewer,r=t.createDevPanel();t.createActivityPanel(document.getElementsByName("activityPanel")[0]);var n=setInterval(function(){e||4<o?(clearInterval(n),chartBoard=t.createChart(document.getElementById("graphCanvas")),4<o&&!debug&&alert(word.informerAlert)):yahooWeatherData?e=t.createInformer(document.getElementsByName("informer")[0],yahooWeatherData):console.log("Can`t get data from Yahoo Weather");o++},1e3),o=0;function i(){get(serverRoot+"current",a)}function a(e){e&&debug&&console.log("GET DATA:"+JSON.stringify(e));try{r.indoorTherm.setValue(e.tIn),r.hygrometer.setValue(e.humid),r.barometer.setValue(e.baro),r.outdoorTherm.setValue(e.tOut)}catch(e){console.log("in setDeviceValues ERROR\n"+e.name+" "+e.message)}}setTimeout(i,2500),setInterval(i,2e4)}(),function(){var o={},w=document.forms.checkDuration,l=w.elements.submitButton;l.setAttribute("disabled","disabled"),l.addEventListener("click",function(){var e,t,r,d=(n=M(w.elements.sensorSelect),o=k[n],o.name=n,o);var n,o;1===p.selectedIndex&&(e="lastValues?sensor="+d.name,get(e,function(e){var t,r,n,o,i,a,l,s;e?(t=d,r=e,a="    "+word.time,l=t.text,s={values:function(e){o=r.last,n=new Array(r[e].length),i=n.length;for(var t=0;t<i;t++)n[t]=r[e][t];for(o=i+o+1,t=0;t<i;t++)n[t]=r[e][(o+t)%i];return n}(t.name),xAxisLabels:function(){var e,t,r=new Date,n=[];r.setSeconds(r.getSeconds()-3900);for(var o=0;o<13;o++)r.setSeconds(r.getSeconds()+300),e=9<(e=r.getHours())?e:"0"+e,t=9<(t=r.getMinutes())?t:"0"+t,n[o]=e+":"+t;return n}()},L(a,t.yLabel,t.color,l,s,t.edges)):console.log("not get data")}));if(2===p.selectedIndex)if(r=M(y),0<C.selectedIndex){if(t=M(C),!function(e,t){var r=!0;(r=E.hasOwnProperty(e)&&E[e]instanceof Array)&&(r=0<=E[e].indexOf(t));return r}(r,t))return console.log('test.js: such interval NOT FOUND "'+r+"/"+t+'"'),void alert("Error");var i=r+"/"+t+".txt";N(i,function(e){A.selectedIndex<1?T(d,e):function(e,t,r){for(var n=t.split("\n"),o=[],i=[],a=0,l=n.length-1,s=0;s<l;s++)if(n[s]=n[s].trim(),!(n[s].length<3)){var d=n[s].split(/\s/),h=NaN;if(1<d[0].length){var u="0"===d[0].charAt(0)?Number(d[0].charAt(1)):Number(d[0]);u===r&&(0==a?d[1]:d[1],h=Number(d[e.numInData]),!isNaN(h)&&h>e.edges.min&&h<e.edges.max&&(o[a]=h,i[a]=d[1],a++))}else console.log("Error dayData is not String-'"+d[0]+"'  dayD[1]="+d[1])}var c=word.hour,m=C.getElementsByTagName("option")[C.selectedIndex].innerHTML;3<m.length&&(m=m.substr(0,3)+". ");var f=" "+e.text+word.by+r+" "+m+" "+M(y)+word.year,g=e.edges;o.length<1?L("","","red",word.noDataFor+f,[0,0,0,0,0,0],{min:-1,max:1}):o.length===i.length&&(o={values:o,xAxisLabels:i});L(c,e.yLabel,e.color,f,o,g)}(d,e,A.selectedIndex)})}else a=d,l=r,c=[],m=[],f=0,g=word.month,b=word.baro+word.by+l+word.year,v=!1,function(n,o){var i={};if(debug&&console.log("test.js [ start fill data for year "+n+" ]"),E.hasOwnProperty(n)){var a=E[n];a.length<1&&o(i);var l=0;!function t(e){var r=n+"/"+a[l]+".txt";N(r,function(e){e&&(i[a[l]]=e),++l==a.length?o(i):t(l)})}()}else o(i)}(l,function(e){if("{}"==JSON.stringify(e))return console.log("test.js(drawYearChart) - Get empty year data for "+l),alert(word.noDataFor+l),L("","","red","",[0,0,0,0,0],{min:-1,max:1}),1;var t,r;for(var n in e){for(console.log("parse montchs p="+n),v||(v=n),c[f]=shortWord[(n+"").toLowerCase()],s=e[n].split("\n"),h=s.length-1,t=u=0;t<h;t++)(r=Number(s[t].trim().split(/\s/)[a.numInData]))<a.edges.min||r>a.edges.max||(u+=r);m[f]=0<u?parseInt(u/(t+1)+.5001):parseInt(u/(t+1)-.5001),f++}if(1==c.length){debug&&console.log("test.js try draw year chart as Month");var o=C.getElementsByTagName("option");for(t=0;t<o.length;t++)-1<o[t].getAttribute("value").indexOf(v)&&o[t].setAttribute("selected","selected");N(l+"/"+M(C)+".txt",function(e){return T(a,e),!0})}return debug&&console.log("year chart: [ "+c+" ]     [ "+m+" ]"),1!=c.length&&L(g,a.yLabel,a.color,b,{values:m,xAxisLabels:c},a.edges),!1}),setTimeout((x=word.noDataFor+" "+a.text+word.by+l+word.year,void(f<1&&L("","","red",x,[0,0,0,0],{min:-1,max:1}))),6e3);var a,l,s,h,u,c,m,f,g,b,v,x});var p=w.elements.intervalSelect;p.addEventListener("click",function(){1==p.selectedIndex&&l.hasAttribute("disabled")&&l.removeAttribute("disabled");if(2==p.selectedIndex){var e=serverRoot+"availablePeriod";get(e,t),E&&(document.getElementsByName("fYearLabel")[0].style.color="#403030",document.getElementsByName("fMonthLabel")[0].style.color="#404030")}});var y=w.elements.yearSelect;y.addEventListener("click",function(){if(y.selectedIndex<1)return;for(var e=C.getElementsByTagName("option"),t=E[M(y)],r=1;r<e.length;r++)t.indexOf(e[r].getAttribute("value"))<0?e[r].setAttribute("disabled","disabled"):e[r].hasAttribute("disabled")&&e[r].removeAttribute("disabled");e[0].hasAttribute("disabled")&&e[0].removeAttribute("disabled");C.selectedIndex=0,A.selectedIndex=0,A.hasAttribute("disabled")||A.setAttribute("disabled","disabled");0<t.length&&(l.hasAttribute("disabled")&&l.removeAttribute("disabled"),C.hasAttribute("disabled")&&C.removeAttribute("disabled"))});var C=w.elements.monthSelect;C.addEventListener("click",function(){if(C.selectedIndex<1)return;N(M(y)+"/"+M(C)+".txt",function(e){e&&function(e){var t=e.split("\n");if(t.length<1)return;for(var r,n=[],o=-1,i=0,a=0;a<t.length;a++)(r=t[a].trim().split(/\s/)[0])!=o&&(n[i]=r,o=r,i++);var l,s=A.getElementsByTagName("option");for(A.selectedIndex=0,a=0;a<s.length;a++)(l=s[a].getAttribute("value"))<9&&(l="0"+l),n.indexOf(l)<0?s[a].setAttribute("disabled","disabled"):s[a].hasAttribute("disabled")&&s[a].removeAttribute("disabled");A.hasAttribute("disabled")&&A.removeAttribute("disabled");s[0].hasAttribute("disabled")&&s[0].removeAttribute("disabled")}(e)})});var A=w.elements.daySelect,e="sensorData?period=",k={tIn:{edges:{min:0,max:40},yLabel:word["tIn.label"],color:"#a85",text:word["tOut.text"],numInData:2},tOut:{edges:{min:-50,max:50},yLabel:word["tOut.label"],color:"#959",text:word["tOut.text"],numInData:3},baro:{edges:{min:600,max:800},yLabel:word["baro.label"],color:"gray",text:word["baro.text"],numInData:4},humid:{edges:{min:0,max:100},yLabel:word["humid.label"],color:"#46b",text:word["humid.text"],numInData:5}};C.addEventListener("click",function(){0<C.selectedIndex&&A.hasAttribute("disabled")&&(A.removeAttribute("disabled"),document.getElementsByName("fDayLabel")[0].style.color="#403030"),C.selectedIndex<1&&!A.hasAttribute("disabled")&&(A.setAttribute("disabled","disabled"),document.getElementsByName("fDayLabel")[0].style.color="#ac9999")});var M=function(e){return e.getElementsByTagName("option")[e.selectedIndex].getAttribute("value")},v=function(e){return e.getElementsByTagName("option")[e.selectedIndex].innerHTML};function T(e,t){debug&&console.log("drawMonthChart for sensor="+e.name+"  month="+M(C)+" data: \n "+t+"\n____EOF___");var r=t.split("\n"),n=r.length-1,o=v(C)+" "+M(y)+word.year,i=word.number;if(n<0)L("","","#f99",word.noDataFor+" "+e.text+word.by+o,[0,0,0,0,0,0,0],{min:-1,max:1});else{var a=[],l=[],s=r[0].trim().split(/\s/),d=s[0],h=1,u=Number(s[e.numInData]);(isNaN(u)||u<e.edges.min||u>e.edges.max)&&(u=0);for(var c=0,m=0,f=1;f<r.length;f++)if(d==(s=r[f].trim().split(/\s/))[0]){if(m=Number(s[e.numInData]),isNaN(m)||m>e.edges.max||m<e.edges.min)continue;u+=m,h++}else f<n?(l[c]=d,a[c]=u<0?parseInt(u/h-.5001):parseInt(u/h+.5001),d=s[0],u=Number(s[e.numInData]),h=1,c++):(l[c]=d,a[c]=u<0?parseInt(u/h-.5001):parseInt(u/h+.5001));if(0!=c){var g=" "+e.text+word.by+o,b={values:a,xAxisLabels:l};L(i,e.yLabel,e.color,g,b,e.edges)}else L(i,"     ",e.color,word.by+d+"/"+o+" "+word.meanFor+e.text+" = "+a[0],[0,0,0,0],{min:-1,max:1})}}function L(e,t,r,n,o,i){chartBoard.setAxisLabels(e,t),chartBoard.chartColor(r),chartBoard.create(n,o,i)}var E={};function t(e){var t;if(e&&e instanceof Array&&!(e.length<1)){var r,n="",o=0;for(var i in e){var a=e[i].substring(6,10);debug&&i<1&&console.log("First year = "+a),n!=a?(""!=n&&s(n,r),r=[],n=a,o=0):o++,t=e[i].substring(11,14),r[o]=t}""!=n&&s(n,r),debug&&console.log("availablePeriods: "+JSON.stringify(E)),function(){var e,t=y.getElementsByTagName("option"),r=!1;for(e=0;e<t.length;e++)E[t[e].getAttribute("value")]?(t[e].hasAttribute("disabled")&&t[e].removeAttribute("disabled"),r||(y.selectedIndex=e,r=!0)):t[e].setAttribute("disabled","disabled");0<e&&(t[0].innerHTML="&nbsp;&nbsp!!!!",y.selectedIndex=0);C.selectedIndex=0,(A.selectedIndex=0)<t.length&&(l.hasAttribute("disabled")&&l.removeAttribute("disabled"),y.hasAttribute("disabled")&&y.removeAttribute("disabled"))}()}else E={}}function s(e,t){E[e]=t}function N(r,n){o.hasOwnProperty(r)?(debug&&console.log("get data from cache"),n(o[r])):(debug&&console.log("test.js try get data from server"),get(e+r,function(e){if(e){var t=function(e){var t,r="",n=e.split("\n");if(n.length<1)return!1;for(var o=0;o<n.length;o++)-1<n[o].search(/[^\s\d-]/)||6==(t=n[o].trim().split(/\s/)).length&&(isNaN(t[2])||1e3<t[2]||t[2]<-1e3||isNaN(t[3])||1e3<t[3]||t[3]<-1e3||isNaN(t[4])||1e3<t[4]||t[4]<-1e3||isNaN(t[5])||1e3<t[5]||t[5]<-1e3||(r+=n[o]+"\n"));return!(r.length<14)&&r}(e);t?function(e,t){if(o.hasOwnProperty(e))return;o[e]=t}(r,t):console.log("test.js [ GET WRONG DATA FOR PERIOD "+r+" ] "),n(t)}else console.log("test.js [ GET EMPTY DATA FOR PERIOD "+r+" ] "),n(!1)}))}}();
