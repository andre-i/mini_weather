function Measurer(t,l){"use strict";var e=navigator.userAgent.toLowerCase(),S=!(e.search("firefox")<0);S&&58.9<e.substring(e.length-4)&&(S=!1);var c,r={strokeCol:"#744",devBordStartCol:"#eef",devBordStopCol:"#851",fill:"#ffe",textCol:"#332",brightnessCol:"#fff",devBorderCol:"#530",labelCol:"#322",scaleCol:"red",scaleBordCol:"#132",arrStrokeCol:"#010",arrFillCol:"#864"},n={minValue:0,maxValue:100,scaleDivideCount:10},o={height:Math.round(.36*a()),width:Math.round(.12*a()),curValue:0,strokeWidth:1,hasScaleLabels:!0,hasLabel:!0,hasEdgeCircle:!0,hasGlass:!0,hasRoundRect:!0,label:""},i={label:"",alpha:0,startAngle:0,stopAngle:180,width:Math.round(a()/4.1),strokeWidth:1,hasRound:!0};function a(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)}var s=(Math.random()*(new Date).getSeconds()+"").substring(0,6),m=document.createElement("div"),f=document.createElement("div");f.appendChild(m),f.setAttribute("class","bigSize");var d,g=document.getElementsByTagName("body")[0];var h={};if(l){if(null==t||!(t instanceof HTMLElement))return console.log(" new created device has no owner container(tag) i get - "+t),void(d=null);d=null,function(){var t;for(var e in l.hasOwnProperty("bounds")&&(t=l.bounds),n)t&&t.hasOwnProperty(e)?h[e]=t[e]:h[e]=n[e]}(),function(){var t;for(var e in l.hasOwnProperty("colors")&&(t=l.colors),r)t&&t.hasOwnProperty(e)?h[e]=t[e]:h[e]=r[e]}(),h.owner=t,l.hasOwnProperty("rect")&&(!function(){var t=l.rect;for(var e in o)t&&t.hasOwnProperty(e)?h[e]=t[e]:h[e]=o[e];t&&t.hasOwnProperty("fontSize")&&(o.fontSize=t.fontSize),t&&t.hasOwnProperty("scaleWidth")&&(o.scaleWidth=t.scaleWidth)}(),d=function(C){var r,A,k,M,T,L,E,N,B=!1,O=0,I=null,S=null,D=null,W=null,n=0,o=!1;function t(t){if(null==W)return!1;if(t>C.maxValue||t<C.minValue)return console.log("WARNING linearDevice get wrong current value "+t),a(n="ERR"),!1;n=t;var e=(t-=C.minValue)*k/Math.abs(C.minValue-C.maxValue),r=""+(T-e);return W.setAttribute("y",r),W.setAttribute("height",""+e),o&&a(n),!0}function e(t){a((o=t)?n:"?")}function i(t){A=C.hasOwnProperty("scaleWidth")?Math.round(C.scaleWidth*C.width/100):Math.round(C.width/10),T=Math.round(.87*C.height),L=Math.round(.12*C.height),M=(k=T-L)/C.scaleDivideCount,N=C.height/40,C.strokeWidth=Math.round(C.height/200),N<2&&(N=2),E=Math.round(C.width/2-N),O=k/C.scaleDivideCount-4*C.strokeWidth,t&&O<8&&(O=8)}function a(t){return null!=D&&(D.textContent=""+t,!0)}var l,s,d=!1;function H(){d?d&&(f.parentNode.removeChild(f),m.innerHTML="",C.height=l,C.width=s,O=c,i(!0),h(C.owner),t(n),d=!1):d||(g.appendChild(f),c=O,l=C.height,s=C.width,C.height=Math.round(.85*document.body.clientHeight),C.width=Math.round(s*C.height/l),i(!0),m.setAttribute("style","height:"+C.height+"px;padding-top:"+3*C.height/34+"px;"),h(m),t(n),d=!0)}function P(){e(!o)}function h(t){var e,r,n;B?(n=C.width,r=C.height,e=" transform='rotate(90) translate(0, -"+C.height+")' >"):(n=C.height,r=C.width,e=" >"),t.innerHTML="<svg width='"+r+"' height='"+n+"' viewBox='0,0 "+r+" "+n+"' xmlns='http://www.w3.org/2000/svg'></svg>",I=t.getElementsByTagName("svg")[0];var o,i,a,l,s,d,h,u,c,m,f,g,b,v,x,w,p,y="<g id='"+C.id+"group' "+e;return y+=function(){C.gradId=C.brightnessId+"Rgrad";var t="<defs> <radialGradient id='"+C.gradId+"' cx='50%' cy='50%' > ";return t+=" <stop offset='25%' stop-color='"+C.devBordStartCol+"' opacity='0.5' />",t+=" <stop offset='75%' stop-color='"+C.devBordStartCol+"'/>",t+="  <stop offset='99%' stop-color='"+C.devBordStopCol+"'  />",t+="</radialGradient>"}(),y+="<linearGradient  id='"+C.id+"scale' x1='0' y1='0' x2='100%' y2='0' ><stop offset='0%' stop-color='black' stop-opacity='0.5' /><stop offset='37%' stop-color='#fff' stop-opacity='0.2' /><stop offset='45%' stop-color='#fff' stop-opacity='0.4' /><stop offset='55%' stop-color='#fff' stop-opacity='0.2' /><stop offset='100%' stop-color='black' stop-opacity='0.6' /></linearGradient></defs> ",y+=(x=C.strokeWidth,w=C.height-C.strokeWidth,p="",C.hasRoundRect&&(p=" rx='"+2*N+"' ry='"+2*N+"' "),"<rect name='housing' x='"+x+"' y='"+x+"'  width='"+(C.width-2*C.strokeWidth)+"' height='"+(C.height-2*C.strokeWidth)+"' "+p+" stroke='"+C.devBorderCol+"' stroke-width='"+1.3*C.strokeWidth+"' fill='"+C.devBordStartCol+"' /><line x1='"+2*N+"' y1='"+x+"' x2='"+(C.width-2*N)+"' y2='"+x+"' stroke='"+C.devBorderCol+"' stroke-width='"+C.strokeWidth+"' /><line x1='"+2*N+"' y1='"+w+"' x2='"+(C.width-2*N)+"' y2='"+w+"' stroke='"+C.devBorderCol+"' stroke-width='"+C.strokeWidth+"' />"),y+=(o="<rect ",o+=" name='brightness' x='"+(E-O)+"' y='"+(L-O/2)+"'  width='"+2*O+"' height='"+(k+O)+"'  rx='"+O/2+"' ry='"+O/3+"' opacity='0.4' fill='"+C.brightnessCol+"' />"),C.hasLabel&&(y+=(g=" ",b=1.2*N,v=(f=k/10-N/2)+N/2,B&&(g=" transform='rotate(-90 "+v+" "+v+") translate( -"+k+" , -"+2*C.strokeWidth+")' "),"<text name='housing'  x='"+b+"' y='"+v+"' fill='"+C.labelCol+"' "+g+" font-size='"+f+"' >"+C.label+"</text>")),y+=(i="<rect ",i+=" x='"+(E-A/2)+"' y='"+(L-C.strokeWidth/2)+"'  width='"+A+"' height='"+(k+C.strokeWidth)+"'  stroke='"+C.scaleBordCol+"' stroke-width='"+C.strokeWidth+"'  fill='none' /> "),C.hasEdgeCircle&&(y+=(m="<circle r='"+(u=.9*A)+"' cx='"+E+"' cy='"+(c=T+u)+"'  stroke='"+C.scaleBordCol+"' stroke-width='"+C.strokeWidth+"'  fill='"+C.scaleCol+"' />",C.hasGlass&&(m+="<circle r='"+(u-C.strokeWidth/2)+"' cx='"+E+"' cy='"+c+"'   fill='url(#"+C.id+"scale)' />"),m+="<rect  x='"+(E-A/2+C.strokeWidth/2)+"' y='"+T+"'  width='"+(A-C.strokeWidth)+"' height='"+1.3*C.strokeWidth+"'  fill='"+C.scaleCol+"' /> ")),y+=function(){for(var t,e=E+A/2+C.strokeWidth,r=E+A/2+C.width/7,n="",o=2*C.scaleDivideCount+1,i=M/2,a=0;a<o;a++)n+=" <line x1='"+e+"' y1='"+(t=L+a*i)+"'' x2='"+(r-a%2*O/3)+"' y2='"+t+"' stroke='"+C.strokeCol+"' stroke-width='"+C.strokeWidth+"' /> ";return n}(),C.hasScaleLabels&&(y+=function(){var t,e=0,r=E+A/2+C.width/7+.8*O;if(O<10)return"<text x='"+(t=r)+"' y='"+(T+7)+"' font-size='14' fill='"+C.strokeCol+"' >"+C.minValue+"</text> <text x='"+t+"' y='"+(L+4)+"' font-size='14' fill='"+C.strokeCol+"' >"+C.maxValue+"</text> ";for(var n=T+C.strokeWidth/2,o=(C.maxValue-C.minValue)/C.scaleDivideCount,i="' fill='"+C.textCol+"' font-style='plain'  text-anchor='middle'",a="",l=0;l<C.scaleDivideCount+1;l++){var s=Math.round(10*(C.minValue+o*l))/10;a+="<text name='housing'  x='"+r+"' y='"+(e=n-l*M)+"' "+i,B&&(a+=" transform='rotate(-90 "+r+" "+e+")' "),a+=0==s?" font-weight='bold' font-size='"+(O+2*C.strokeWidth)+"' >":" font-size='"+O+"' >",a+=s+"</text>"}return a}()),y+="<rect name='scale'  x='"+(E-A/2+C.strokeWidth/2)+"' y='"+(T-C.strokeWidth)+"'  width='"+(A-C.strokeWidth)+"' height='0' fill='"+C.scaleCol+"' />",C.hasGlass&&(y+=(h=E-A/2,d=C.hasRound?k+2.3*C.strokeWidth:k+1.5*C.strokeWidth,"<rect x='"+h+"' y='"+L+"' width='"+A+"' height='"+d+"' fill='url(#"+C.id+"scale)' />")),y+=(a=k/10-N/2,l=C.height-a-N/2-2*C.strokeWidth,s="<rect x='"+(3*C.width/4-1.2*a)+"' y='"+l+"'  width='"+2.15*a+"' height='"+a+"'  fill='"+C.devBordStartCol+"'  stroke='"+C.strokeCol+"'  stroke-width='"+C.strokeWidth+"' opacity='1' /><text  name='text'' x='"+(3*C.width/4-C.strokeWidth)+"' y='"+(C.height-N-C.strokeWidth)+"' text-anchor='middle' fill='"+C.textCol+"' font-size='"+a+"' >?</text>",s+="<rect name='valuesPane' x='"+(3*C.width/4-1.1*a)+"' y='"+(l+C.strokeWidth)+"'  width='"+2*a+"' height='"+(a-2*C.strokeWidth)+"'  fill='"+C.devBordStartCol+"' opacity='0.1' />"),I.innerHTML=y+"</g>",function(){for(var t,e=I.childNodes[0],r="",n=0;n<e.childNodes.length;n++){t=e.childNodes[n];try{t instanceof Text||!t.hasAttribute("name")||("scale"==(r=t.getAttribute("name"))&&(W=t),"brightness"==r&&(t.addEventListener("click",H),S=t),"text"==r&&(D=t),"valuesPane"==r&&t.addEventListener("click",P),"housing"==r&&t.addEventListener("click",H))}catch(t){}}}(),!0}var u=!1;return function(){var t;if(r=C.brightnessCol,C.width%5!=0){for(t=Math.round(C.width);t%6!=0;)t++;C.width=t}if(!function(){var t=!0;if(C.hasOwnProperty("scaleWidth")){var e=C.scaleWidth;(e!=e||91<Math.abs(e-100))&&(t=!1)}if(C.hasOwnProperty("fontSize")&&(O!=O||O<8||100<O))return!1;if((C.height!=C.height||C.height<10||C.width!=C.width||C.width<10||C.strokeWidth!=C.strokeWidth||C.strokeWidth<1||C.maxValue!=C.maxValue||C.minValue!=C.minValue||C.scaleDivideCount!=C.scaleDivideCount||C.scaleDivideCount<1)&&(t=!1),!t)throw console.log("ERROR : wrong start parameter"),new Error("Illegal value og parameter");return t}())throw u=!0,new Error("init param wrong");if(C.height<=C.width){var e=C.width;C.width=C.height,C.height=e,B=!0}i(!1),h(C.owner),u=!1}(),u?null:{setValue:t,brightness:function(t){return null!=S&&(S.setAttribute("fill",t),C.brightnessCol=t,!0)},getBrightness:r,showValue:e}}(h)),l.hasOwnProperty("oval")&&(!function(){var t=l.oval;for(var e in i)t.hasOwnProperty(e)?h[e]=t[e]:h[e]=i[e];t.hasOwnProperty("fontSize")&&(i.fontSize=t.fontSize),t.hasOwnProperty("hasRound")&&0==t.hasRound&&(h.width=Math.round(h.width+h.width/10))}(),d=function(p){var t,y,C=40,A=null,k=null,M=null,T=void 0,r=!1,n=0,L=!1,E=0;function e(t){o((L=t)?E:"?")}function o(t){return null!=M&&(M.textContent=t,!0)}function N(){r?r&&(f.parentNode.removeChild(f),m.innerHTML="",p.width=n,y=c,i(p.owner),r=!1):function(){if(!r){g.appendChild(f),c=y,n=p.width;var t=document.body.clientHeight,e=document.body.clientWidth;p.width=t<e?Math.round(.85*t):Math.round(.85*e),y=y*p.width/n,T.innerHTML="<svg  width='"+p.width+"' height='"+p.width+"' viewBox='0,0 "+p.width+" "+p.width+"' xmlns='http://www.w3.org/2000/svg'></svg>",m.setAttribute("style","padding-top:"+(t-p.width)/2+"px; height: "+p.width+"px;"),i(m),r=!0}}()}function B(){e(!L)}function i(t){var e=p.hasRound?p.width:.9*p.width;t.innerHTML="<svg  width='"+p.width+"' height='"+e+"' viewBox='0,0 "+p.width+" "+p.width+"' xmlns='http://www.w3.org/2000/svg'></svg>",(T=t.getElementsByTagName("svg")[0]).innerHTML="";var r,n,o,i,a,l,s,d,h,u,c,m,f,g,b,v,x,w=function(){p.gradId=p.brightnessId+"Cgrad";var t="<defs> <radialGradient id='"+p.gradId+"' cx='50%' y='30%'> ";return t+=" <stop name='brightness' offset='5%' stop-color='"+p.brightnessCol+"' /> <stop offset='25%' stop-color='"+p.brightnessCol+"'  /> <stop offset='45%' stop-color='"+p.fill+"' /> <stop offset='93%' stop-color='"+p.fill+"' /> <stop offset='98%' stop-color='"+p.devBordStartCol+"' /> </radialGradient> </defs> <defs><radialGradient id='"+p.gradId+"1' cx='50%' y='50%'> ",t+=" <stop offset='80%' stop-color='"+p.devBordStartCol+"'/>",t+="  <stop offset='90%' stop-color='"+p.devBordStopCol+"'  />",t+="  <stop offset='93%' stop-color='"+p.devBordStopCol+"'  />",t+=" <stop offset='98%' stop-color='"+p.devBordStartCol+"' />",t+=" <stop offset='100%' stop-color='"+p.devBordStartCol+"'  />",t+="</radialGradient> </defs>"}()+(r="<ellipse name='flip' ",n=p.width/2-p.strokeWidth,o=p.hasRound?n:.43*p.width,r+=" cx='"+p.width/2+"' cy='"+p.width/2+"'  rx='"+n+"' ry='"+o+"' stroke='"+p.devBorderCol+"' stroke-width='"+2*p.strokeWidth+"'  fill='url(#"+p.gradId+"1)' /> <ellipse cx='"+p.width/2+"' cy='"+p.width/2+"'  rx='"+n+"' ry='"+o+"' stroke='"+p.devBorderCol+"' stroke-width='"+2*p.strokeWidth+"'  fill='none' /> ");w+=function(t,e,r,n,o,i){(t!=t||t<1||50<t)&&(50<t&&(t=50),t<1&&(t=1),console.log('WARNING gigro: "radius oval`s must be digits in percents (from 1 to 50)" '));var a="<circle  name='flip' ";null==e&&(e=p.strokeCol),null==r&&(r=p.strokeWidth),null==n&&(n="none"),null==o&&(o=p.width/2),null==i&&(i=p.width/2);for(var l=[Math.round(p.width*t/100)-r,o,i,e,r,n],s=0;s<6;s++)a+=O[s]+l[s];return a+="' /> "}(C,void 0,2*p.strokeWidth,"url(#"+p.gradId+")"),w+=function(){for(var t="",e=(p.stopAngle-p.startAngle)/p.scaleDivideCount,r=p.width/2+2*p.strokeWidth-Math.round(C*p.width/100),n=r+Math.round(C*p.width/650),o=p.width/2,i=400<p.width?4*p.strokeWidth:5*p.strokeWidth/3,a=0;a<=p.scaleDivideCount;a++)t+=I(!0,r,o,n,o,p.startAngle+a*e,p.strokeCol,i);if(10<e){n=r+(n-r)/2,e/=5,i/=2;var l=5*p.scaleDivideCount+1;for(a=0;a<l;a++)t+=I(!0,r,o,n,o,p.startAngle+a*e,p.strokeCol,i)}return t}(),w+=function(){for(var t,e,r=(p.stopAngle-p.startAngle)/p.scaleDivideCount,n=C*p.width/150,o=S?y/2.4:y/2,i=" ",a=p.scaleDivideCount+1,l=0,s=80<C*p.width/100,d=14<p.scaleDivideCount,h=0;h<a;h++){var u=Math.PI/180*(p.startAngle+h*r);if(0!=h&&h!=p.scaleDivideCount||(l=o/4),0==h||h==p.scaleDivideCount||s){if(d&&h%2!=0)continue;t=Math.round(p.width/2-n*Math.cos(Math.PI/180+u)),e=Math.round(p.width/2-n*Math.sin(Math.PI/180+u)),i+="<text name='flip' text-anchor='middle' font-size='"+(o+l)+"' ",i+=" fill='"+p.textCol+"' x='"+t+"' y='"+e+"' >",i+=p.minValue+h*Math.round((p.maxValue-p.minValue)/p.scaleDivideCount)+"</text>"}}return i}(),w+=(i=S?"50%":"0%",a=S?y/1.42:y/1.3,l=p.width*C/220,s=p.width/2,d=4*p.width/7,"<defs> <path  id='"+p.id+"labelPath'  d='M "+(s-l+y/6)+", "+(d+y/5)+" C "+(s-l+y/2)+", "+d/2+" "+(s+l-y/2)+", "+d/2+" "+(s+l-y/4)+", "+d+"' /> </defs><text  x='"+(s-l-y/6)+"' y='0%'  font-size='"+a+"' fill='"+p.labelCol+"'  text-anchor='middle' > <textPath xlink:href='#"+p.id+"labelPath' startOffset='"+i+"' >"+p.label+"</textPath></text> "),w+=(h=L?E:"?",u=1.4*y,c=Math.round(u/4),m=Math.round(p.width*(.5+3*C/400)),f="<rect x='"+(p.width/2-1.1*u)+"' y='"+(m-3.2*c)+"'  width='"+2.2*u+"' height='"+(u-.2*c)+"'  stroke='"+p.devBorderCol+"' stroke-width='"+c/5+"'  fill='"+p.devBordStartCol+"' />",f+="<text x='"+p.width/2+"' y='"+m+"'  name='text' text-anchor='middle' opacity='0.8'  font-size='"+u+"' fill='"+p.textCol+"' >"+h+"</text> ",f+="<rect name='valuesPane' x='"+(p.width/2-1.15*u)+"' y='"+(m-3.25*c)+"'  width='"+2.1*u+"' height='"+(u-.3*c)+"'  fill='"+p.devBordStartCol+"' opacity='0.1' />"),w+=(g=p.width/2,b=p.width/2,v=400<p.width?C/3:C/6,x="<polygon name='arrow' ",x+=" points='"+(g+2*v)+","+b+" "+(g+3*v)+","+(b+v)+" ",x+=g-Math.round(C*p.width/110)+","+b+" "+(g+3*v)+","+(b-v)+"' ",x+=" stroke='"+p.arrStrokeCol+"' stroke-width='"+2*p.strokeWidth/3+"' ",x+=" transform='rotate("+p.alpha+" "+g+" "+b+")' fill='"+p.arrFillCol+"' /> ",x+="<circle r='"+v/4+"' cx='"+g+"' cy='"+b+"' fill='black' />"),T.innerHTML=w,function(){for(var t=T.getElementsByTagNameNS("http://www.w3.org/2000/svg","stop"),e=0;e<t.length;e++)t[e].hasAttribute("name")&&"brightness"==t[e].getAttribute("name")&&(A=t[e]);A.addEventListener("click",N);var r,n="";for(e=0;e<T.childNodes.length;e++){r=T.childNodes[e];try{!(r instanceof Text)&&r instanceof Node&&r.hasAttribute("name")&&("arrow"==(n=r.getAttribute("name"))&&(k=r),"text"==n&&(M=r),"flip"==n&&r.addEventListener("click",N),"valuesPane"==n&&r.addEventListener("click",B))}catch(t){console.log(t)}}}()}var O=[" r='","' cx='","' cy='","', stroke='","' stroke-width='","' fill='"];function I(t,e,r,n,o,i,a,l){null==a&&(a=p.strokeCol),null==l&&(l=p.strokeWidth);var s="<line ";return null==n&&(n=p.width/2),null==o&&(o=p.width/2),s+="x1='"+e+"' y1='"+r+"' x2='"+n+"' y2='"+o+"' ",s+=" stroke='"+a+"' stroke-width='"+l+"' ",null!=i&&0!=i&&(s+=" transform='rotate("+i,s+=t?", "+p.width/2+", "+p.width/2+")' ":")' "),s+=" /> "}var a=!1;return function(){p.owner.innerHTML="",t=p.brightnessCol;try{p.width=Math.round(p.width),p.width%2!=0&&p.width++,n=p.width,a=function(){if(p.hasOwnProperty("fontSize")){var t=l.fontSize;if(t!=t||t<8||100<t)return console.log("ERROR Illegal start parameter fontSize it must be from 8 to 100"),!1;y=t}else(y=Math.round(p.width*C/340))<8&&(y=8);return!0}(),p.id=s,p.brightnessId=s+"brigID",i(p.owner)}catch(t){throw console.log("measurer.js - ERROR on start device: "+t.toString()),console.log("ON START DEVICE I have parameters:"),a=!1,t}}(),a?{flip:N,setValue:function(t){if(null==k)return!1;if(t!=t||t<p.minValue||t>p.maxValue)return console.log("WARNING out of bounds leave: ("+p.maxValue+" - "+p.minValue+")  i get: "+t),o(E="ERR"),!1;p.alpha=p.stopAngle-(p.stopAngle-p.startAngle)*(p.maxValue-t)/(p.maxValue-p.minValue);var e="rotate("+p.alpha+" "+p.width/2+" "+p.width/2+")";return k.setAttribute("transform",e),E=t,L&&o(E),!0},brightness:function(t){return null!=A&&(A.setAttribute("stop-color",t),p.brightnessCol=t,!0)},getBrightness:t,showValue:e}:null}(h))}return d}function Plotter(t,g,b,e){if(null==t&&!(t instanceof HTMLElement))return console.log("'painter' parameter must be HTML container. I get: "+t),null;if(g!=g||b!=b||g<40||b<40)return console.log("plotter.js:  WARNING wrong width or height parameters"),null;var v,x,w,p,y,C,k={borderCol:"#623",bgCol:"#faf9e5",axisCol:"#541",labelCol:"#255"},r=t,M=Math.round(b/100),T=Math.round(b/250);T<1&&(T=1);var A,L,E,N=!1,B="#776",O=T,I=!1,S={},D=Math.round(b/25),W="",H="";function P(t,e,r){if(!e||!(e instanceof Array)&&!e.hasOwnProperty("values")||e.length<1)return console.log("plotter.js buildGraph [wrong parameter:second parameter must be array with numerical values or object with values and labels(see plotter.js function buildGraph]"),!1;if("string"!=typeof t)return console.log("buildGraph [wrong parameter: first parameter must be string values"),!1;if(A=t,e instanceof Array)L=e,I=!1;else{if(!(e.values instanceof Array&&0<e.values.length))return console.log('(plotter.js)Error First member object toDraw must have name "values" and contains array of numerical values'),!1;L=e.values,I=!!(e.hasOwnProperty("xAxisLabels")&&e.xAxisLabels instanceof Array&&e.xAxisLabels.length==e.values.length)&&e.xAxisLabels}!function(t){var e={};t&&t.hasOwnProperty("min")&&t.hasOwnProperty("max")?(e.min=t.min,e.max=t.max):(e.min=L[0],e.max=L[0],L.forEach(function(t){return t!=t?(console.log("array for chart contains not numbers:"+t),!1):(e.min>t&&(e.min=t),e.max<t&&(e.max=t),!0)}),e.min==e.max&&(0==e.min?(e.max=10,e.min=-10):(e.max=0<e.max?2*e.max:e.min,e.min=e.min<0?2*e.min:e.min)));S.min=e.min,S.max=e.max}(r);var n,o,i,a,l,s,d,h,u,c,m=function(){var t,e={},r=Math.abs(S.min-S.max),n=0,o=0,i=(r=4<r&&r<10.1?11:r)<10?-1:1;for(;!((t=r/Math.pow(10,i*n))<101&&10<t);)n++;if(n*=i,e.pow=n,(t=Math.round(t)+1)<=31)o=t,t=Math.pow(10,n);else if(t<=61){for(;t%2!=0;)t++;o=t/2,t=2*Math.pow(10,n)}else if(t<91){for(;t%3!=0;)t++;o=t/3,t=3*Math.pow(10,n)}else o=25,t=4*Math.pow(10,n);return e.count=o,e.vOd=t,e.ySpace=(w-y)/(o+2),function(t){var e=0;if(S.max<0){for(;S.max+t.vOd*e<0;)e++;t.startDash=t.count+e-1,t.xAxisPos=w-(t.count+1)*t.ySpace}else if(0<S.min){for(;0<S.min+e*t.vOd;)e--;t.startDash=e+1,t.xAxisPos=w}else if(0<=S.max&&S.min<=0){for(;S.min+t.vOd*e<0;)e++;t.startDash=e,t.xAxisPos=w-e*t.ySpace}}(e),e}(),f=(p-x-3*M)/(L.length+1);return n=L.length,o=f,i=m,v.innerHTML="",V(),u=x+","+(w+M)+" "+x+","+(y+C)+" "+(x-M)+","+(y+C)+" "+x+","+y+" "+(x+M)+","+(y+C)+" "+x+","+(y+C),v.innerHTML+="<polyline  points='"+u+"' stroke='"+k.axisCol+"'  stroke-width='"+T+"'  />",d=i.xAxisPos,h=x-M+","+d+" "+(p-C)+","+d+" "+(p-C)+","+(d-M)+" "+p+","+d+" "+(p-C)+","+(d+M)+" "+(p-C)+","+d,v.innerHTML+="<polyline points='"+h+"' stroke='"+k.axisCol+"' ' stroke-width='"+T+"' />",function(t){if(!(b<260)){var e,r="",n=x+D/3,o=t.count+2,i=t.startDash;o<i?(i=o,R(Math.round(t.xAxisPos+t.ySpace/2)),z(t,(1-t.startDash)*t.vOd,1)):i<0?(i=0,R(Math.round(t.xAxisPos-t.ySpace/2)),z(t,(1-t.startDash)*t.vOd,1)):z(t,0,t.startDash);for(var a=0;a<o;a++)e=t.xAxisPos-(a-i)*t.ySpace,r+="<line x1='"+x+"' y1='"+e+"' x2='"+n+"'  y2='"+e+"'  stroke-width='"+T/2+"' stroke='"+k.axisCol+"'  fill='black' />",r+="<line x1='"+x+"' y1='"+e+"' x2='"+p+"' y2='"+e+"'  stroke-width='"+T/5+"' stroke='#ccc'  fill='#fff' />";v.innerHTML+=r}}(i),a=i.xAxisPos,l="<text  x ='"+(x+2*M)+"' y='"+(y+C)+"'  font-size='"+D+"' text-anchor='start'  fill='"+k.labelCol+"' >"+H+"</text>",s="<text  x='"+(g-C)+"' y='"+(a+(2*D<b-a?1.5*D:-.2*D))+"' ' text-anchor='end' fill='"+k.labelCol+"'  font-size='"+D+"' >"+W+"</text>",v.innerHTML+=s+l,function(t,e,r){for(var n,o="",i=r<=y?r+D/3:r-D/3,a=w-2*M,l=y+2*M,s=1;s<t;s++)o+="<line x1='"+(n=x+s*e)+"' y1='"+r+"'  x2='"+n+"' y2='"+i+"'  stroke='"+k.axisCol+"' stroke-width='"+T/2+"' /> ",o+="<line x1='"+n+"' y1='"+a+"'  x2='"+n+"' y2='"+l+"'  stroke='#ccc' stroke-width='"+T/5+"' /> ";I&&function(t,e){var r=I.length,n=D-M;n<10&&(n=D);var o=w<e+n?e-D/3:e+1.2*n,i=1;20<r?i=3:10<r&&(i=2);for(var a,l='<text x="'+x+'" y="'+o+'"  font-size="'+n+'"  fill="'+k.labelCol+'" >'+I[0]+"</text>",s=1;s<r;s++)a=x+s*t,s%i==0&&(l+='<text x="'+a+'" y="'+o+'"  font-size="'+n+'" text-anchor="middle" fill="'+k.labelCol+'" >'+I[s]+"</text>");v.innerHTML+=l}(e,r),v.innerHTML+=o}(n,o,i.xAxisPos),c=A,v.innerHTML+="<text x='"+g/2+"' + y='"+1.2*D+"'  font-size='"+D+"' text-anchor='middle' fill='"+k.labelCol+"' style='font-style:italic;text-decoration:underline;' ' >"+c+"</text>",function(t,e,r){var n,o,i,a=" fill='"+k.bgCol+"' stroke='"+B+"' stroke-width='"+O+"' />",l=1.2*T,s=r.ySpace,d=w-r.startDash*s,h=s/r.vOd,u=x,c="<g name='chart'>",m=1;20<t.length?m=4:15<t.length?m=3:10<t.length&&(m=2);for(i=1;i<t.length;i++)G(t[i-1],t[i])&&(n=d-h*t[i-1],o=d-h*t[i],c+="<line x1='"+u+"' y1='"+n+"' x2='"+(u+e)+"' y2='"+o+"' "+a,N&&i%m==0&&(c+="<circle cx='"+u+"' cy='"+n+"' r='"+l+"' "+a,c+="<text x='"+u+"' y='"+(n-4*T)+"' text-anchor='middle'  fill='black' font-size='"+D+"' >"+t[i-1]+"</text>")),u+=e;t.length<2&&(o=d-h*t[0]);c+="<circle cx='"+u+"' cy='"+o+"' r='"+l+"' "+a,N&&(c+="<text x='"+u+"' y='"+(o-4*T)+"' text-anchor='middle'  fill='black' font-size='"+D+"' >"+t[i-1]+"</text>");c+="</g>",v.innerHTML+=c}(L,f,m),function(){var t=N?"-":"+";v.innerHTML+='<text x="'+(p-D/2)+'" y="'+(.9*D+M)+'"  font-size="'+(D+2*T)+'" font-weight="bold" text-anchor="middle" fill="#065" >'+t+'</text><rect name="toggle" x="'+(p-D)+'" y="'+M+'" width="'+D+'" height="'+D+'" fill="white" opacity="0.5" stroke="'+k.borderCol+'"  stroke-width="'+T/3+'" />';for(var e=0;e<v.childNodes.length;e++){var r=v.childNodes[e];r instanceof Text||!r.hasAttribute("name")||"toggle"!=r.getAttribute("name")||(r.onclick=function(){return N=!N,P(A,{values:L,xAxisLabels:I},S),0})}}(),!0}function V(){v.innerHTML="<rect name='border' x='"+(M-2)+"' y='"+(M-2)+"'   rx='"+4*T+"' ry='"+4*T+"'  height='"+(b+4)+"' width='"+(g+4)+"' stroke='"+k.borderCol+"' stroke-width='"+T+"' fill='"+k.bgCol+"' />"}function R(t){var e,r=C,n=1.4*C;for(e='<path d="';r<p;)e+="M"+r+","+t+" L"+(r+n)+","+t+" ",r+=2*C;e+='" stroke="#ec0" stroke-width="'+2*T+'" />',v.innerHTML+=e}function d(t){return"string"==typeof t&&4<t.length?x+2.5*D:x-3*T}function z(t,e,r){var n=h(t,e+t.vOd),o=h(t,(t.count-t.startDash)*t.vOd);e=h(t,e);var i=w-t.ySpace*r+D/3,a=w-t.ySpace*t.count+D/3,l=' fill="'+k.labelCol+'" font-size="'+D+'" text-anchor="end" ',s='<text x="'+d(e)+'" y="'+i+'" '+l+" >"+e+'</text><text x="'+d(n)+'" y="'+(i-t.ySpace)+'" '+l+" >"+n+"</text>";v.innerHTML+=s,s='<text x="'+d(o)+'" y="'+a+'" '+l+" >"+o+"</text>",v.innerHTML+=s}function h(t,e){return 0==e||Math.abs(e)<1e-7?0:Math.abs(e)<.1?(e=Math.round(1e3*e),console.log("rounded number="+e),e/100+"*E-2"):.1<Math.abs(e)&&Math.abs(e)<1e3||0==e?(Math.round(e)!=e&&(e=Math.round(100*e)/100),e+""):(e=(e=e/Math.pow(10,t.pow)+"").length<3?e+=".0":e.substring(0,2))+"*E"+t.pow}function G(t,e){return!(t<S.min||t>S.max)&&!(e<S.min||e>S.max)}function n(t){E&&(E.innerHTML="",t.innerHTML="")}return function(){for(var t in k)e&&e.hasOwnProperty(t)&&(k[t]=e[t]);r.width=g,r.height=b,r.innerHTML="<svg  width='"+g+"' height='"+b+"' viewBox='0,0 "+g+" "+b+"' xmlns='http://www.w3.org/2000/svg'></svg>",b-=2*M,g-=2*M,v=r.getElementsByTagName("svg")[0],x=4*M+1.3*D,C=3*M,w=b-2*M,p=g-2*M,y=2*M,D<10&&(!0,D=12),V()}(),{setAxisLabels:function(t,e){W=t,H=e},create:P,hasVisibleValues:function(t){N=t},chartColor:function(t){B=t},simpleChart:function(t,c){if(c.max&&c.min&&!(0<t.getElementsByTagName("svg").length)){var m,s,d,f,g,b,h=t.width-3*M,u=t.height-3*M,v=u-5*M,x=D+2*M,w=h-4*M,p=w/6;for(m in t.innerHTML="<svg  width='"+h+"' height='"+u+"' viewBox='0,0 "+h+" "+u+"' xmlns='http://www.w3.org/2000/svg'></svg>",(E=t.getElementsByTagName("svg")[0]).setAttribute("style","cursor:pointer"),E.onclick=function(){n(t),t.setAttribute("class","noSize")},function(){for(var t in m=1,s=c.min,d=c.max,b=0,g=x+(f=v/(d-s))*d,E.innerHTML+='<rect x="10" y="10" rx="'+5*T+'" ry="'+5*T+'" width="'+(h-20)+'" height="'+(u-20)+'" fill="'+k.bgCol+'" stroke="'+k.borderCol+'" stroke-width="'+T+'" />',c)"min"!=t&&"max"!=t&&(0==b&&0<c[t].points.length&&(b=(w-p)/c[t].points.length),e=c[t].name,r=c[t].color,n=M+m*D,E.innerHTML+='<text x="'+3*M+'" y="'+n+'" fill="'+r+'"  font-size="'+D+'" >'+e+"</text>",m++);var e,r,n,o,i,a,l;0<d&&s<0&&(o=p,i=w,a=g,l=D,E.innerHTML+='<text x="'+(o-M)+'" y="'+(a+l/2)+'"  stroke="'+k.axisCol+'" stroke-width="'+2*T/3+'"  font-size="'+2*l/3+'" text-anchor="end" >0</text>',E.innerHTML+='<line x1="'+o+'" y1="'+a+'" x2="'+i+'"  y2="'+a+'" stroke="'+k.axisCol+'" stroke-width="'+T/2+'" />')}(),c)"min"!=m&&"max"!=m&&e(c[m].points);var y=!1}function e(t){t instanceof Array&&0<t.length&&("number"==typeof t[0]?function(t){for(var e=t[0],r=t[0],n='<polyline points="',o=0;o<t.length;o++)t[o]>r&&(r=t[o]),t[o]<e&&(e=t[o]),n+=p+o*b+","+(g-f*t[o])+" ";n+='" fill="none" stroke="'+c[m].color+'"  stroke-width="'+T+'" />',r=Math.round(r),e=Math.round(e),C(r,e,g-f*r,g-f*e,c[m].color),E.innerHTML+=n}(t):function(t){for(var e,r,n,o,i=Math.round(2*D/3),a=t[0].val,l=t[0].val,s='<polyline points="',d=[],h=0;h<t.length;h++)if(o=t[h].val,a<o&&(a=o),o<l&&(l=o),s+=(r=p+h*b)+","+(n=g-f*o)+" ",t[h].svg&&(n<60&&(n=60),v-60<n&&(n=v-60),(e=t[h].svg).setAttribute("x",r-e.getAttribute("width")/3),e.setAttribute("y",n-e.getAttribute("height")+4),d[h]=e),t[h].text){var u=t[h].text.split(/\n/);E.innerHTML+='<line x1="'+r+'" y1 ="'+x+'"  x2="'+r+'" y2="'+(v-u.length*i)+'" stroke="'+k.axisCol+'"  stroke-width="'+T/3+'" />',1==u.length?E.innerHTML+='<text x="'+r+'" y="'+v+'"  font-size="'+i+'" text-anchor="middle"  stroke="'+k.labelCol+'" stroke-width="1" >'+t[h].text+"</text>":A(r,u,i)}for(h in s+='" fill="none" stroke="'+c[m].color+'"  stroke-width="'+T+'" />',E.innerHTML+=s,a=Math.round(a),l=Math.round(l),C(a,l,g-f*a,g-f*l,c[m].color),d)E.appendChild(d[h])}(t))}function C(t,e,r,n,o){var i="",a=y?w:w-D;y=!y;var l='stroke="'+o+'"  stroke-width="'+T/2+'" ',s='font-size="'+2*D/3+'" text-anchor="end" ';i+='<line x1="'+p+'" y1="'+n+'" x2="'+w+'" y2="'+n+'" '+l+" />",i+='<text x="'+a+'" y="'+(n-2)+'" '+l+s+">"+e+"</text>",i+='<line x1="'+p+'" y1="'+r+'" x2="'+w+'" y2="'+r+'" '+l+" />",i+='<text x="'+a+'" y="'+(r+2*D/3)+'" '+l+s+">"+t+"</text>",E.innerHTML+=i}function A(t,e,r){for(var n=v-(e.length-1)*r+2*T,o=0;o<e.length;o++)E.innerHTML+='<text x="'+t+'" y="'+(n+o*r)+'" font-size="'+r+'" text-anchor="middle" stroke="'+k.labelCol+'" stroke-width="1" >'+e[o]+"</text>"}},clearSimpleChart:n}}function MeteoViewer(){var i,r,n,o,a,l,u=function(t,e){return t.length<3?"":(t=t.trim().substring(0,3).toLowerCase(),e?shortWord[t]:word[t])},c=[],s="http://www.w3.org/2000/svg";function m(){if(!(c.length<2||document.body.clientWidth<document.body.clientHeight)){var t=function(t){for(var e=[],r=[],n={},o=t[0].max,i=t[0].min,a=0;a<t.length;a++){t[a].max>o&&(o=t[a].max),t[a].min<i&&(i=t[a].min);var l=document.createElementNS(s,"image");l.setAttribute("width","52"),l.setAttribute("height","52"),l.setAttributeNS(s,"xlink:href",t[a].picture),e[a]=t[a].min,r[a]={val:t[a].max,svg:l,text:t[a].date}}return n.min=Math.round(i-(o-i)/5),n.max=Math.round(o+(o-i)/10),n.label={name:"&nbsp; &nbsp;"+word.forecast,color:"#752",points:[]},n.space0={name:"",color:"rgba(0,0,0,0)",points:[]},n.maxThemp={name:word.day+" t℃",color:"#909",points:r},n.space1={name:"",color:"rgba(0,0,0,0)",points:[]},n.minThemp={name:word.night+" t℃",color:"#069",points:e},n}(c);null==l&&(l=document.createElement("div")),l.setAttribute("class","bigSize");var e=document.createElement("div");e.width=4*document.body.scrollWidth/5,e.height=5*document.body.scrollHeight/6,e.setAttribute("style","margin-top:"+document.body.scrollHeight/12+"px"),l.appendChild(e),document.body.appendChild(l),i.simpleChart(e,t),l.onclick=function(){i.clearSimpleChart(e),l.setAttribute("class","noSize")}}}return{createDevPanel:function(){var t={devBordStartCol:"rgba(75,95,130,0.3)"},e={label:"&nbsp;t℃"};return r=new Measurer(document.getElementsByName("inThermOwner")[0],{colors:t,bounds:{minValue:0,maxValue:40,scaleDeviceCount:20},rect:e}),n=new Measurer(document.getElementsByName("outThermOwner")[0],{colors:t,bounds:{minValue:-50,maxValue:50,scaleDeviceCount:30},rect:e}),t={devBordStopCol:"rgba(80,90,10,0.2"},o=new Measurer(document.getElementsByName("baroOwner")[0],{bounds:{minValue:650,maxValue:810,scaleDivideCount:16},oval:{label:"&nbsp;"+word["baro.label"],startAngle:-35,stopAngle:215,hasRound:!1},colors:t}),a=new Measurer(document.getElementsByName("hygroOwner")[0],{bounds:{minValue:0,maxValue:100,scaleDeviceCount:10},oval:{startAngle:-10,stopAngle:190,label:"&nbsp;%",hasRound:!1},colors:t}),{indoorTherm:r,outdoorTherm:n,barometer:o,hygrometer:a}},createActivityPanel:function(t){if(document.body.clientWidth<document.body.clientHeight)return null;if(!(t instanceof HTMLElement))return console.log("ERROR can`t create activity panel: I get not HTMLElement:"+t),null;var e,r=["   ","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=[word.all,word.jan,word.feb,word.mar,word.apr,word.may,word.jun,word.jul,word.aug,word.sep,word.oct,word.nov,word.dec],o=document.forms.checkDuration,i=o.getElementsByTagName("label"),a=function(){for(h.setAttribute("disabled","disabled"),u.setAttribute("disabled","disabled"),c.setAttribute("disabled","disabled"),e=0;e<i.length;e++)i[e].setAttribute("class","label")},l=o.elements.sensorSelect,s={empty:"",tOut:word["tOut.text"],tIn:word["tIn.text"],baro:word["baro.text"],humid:word["humid.text"]};for(e in s)l.appendChild(new Option(s[e],e));var d=o.elements.intervalSelect;d.appendChild(new Option("  ","empty")),d.appendChild(new Option("  "+word.lastHour+" ","lastHour")),d.appendChild(new Option(word.checkInterval,"checkInterval")),d.setAttribute("disabled","disabled");var h=o.elements.yearSelect;for(h.appendChild(new Option("","empty")),e=2018;e<2026;e++)h.appendChild(new Option(e,e+""));for(e=0;e<h.getElementsByTagName("option").length;e++)h.getElementsByTagName("option")[e].setAttribute("style","color:");h.setAttribute("disabled","disabled");var u=o.elements.monthSelect;for(e=0;e<r.length;e++)u.appendChild(new Option(n[e],r[e]));u.setAttribute("disabled","disabled");var c=o.elements.daySelect;for(c.appendChild(new Option(word.all," ")),e=1;e<32;e++)c.appendChild(new Option(e+"",e));c.setAttribute("disabled","disabled");var m=o.elements.submitButton;return m.setAttribute("value","getChart"),m.setAttribute("disabled","disabled"),m.setAttribute("class","submitButton"),m.innerHTML=word.build,a(),o.addEventListener("click",function(t){0==l.selectedIndex&&(d.setAttribute("disabled","disabled"),a()),0<l.selectedIndex&&d.hasAttribute("disabled")&&d.removeAttribute("disabled"),0<l.selectedIndex&&1==d.selectedIndex&&a()},!1),o},createChart:function(t){if(document.body.clientWidth<document.body.clientHeight)return null;var e=document.body.clientWidth-1.1*document.getElementsByTagName("aside")[0].offsetWidth,r=getComputedStyle(document.getElementsByTagName("aside")[0]).padding;r=r.substring(0,r.length-2);var n=document.getElementsByName("informer")[0].clientHeight,o=document.getElementsByTagName("aside")[0].clientHeight-Math.max(document.getElementsByName("activityPanel")[0].offsetHeight,n)-4*r;return i=new Plotter(t,e,o,{borderCol:getComputedStyle(document.getElementsByTagName("table")[0]).borderColor})},createInformer:function(t,e){var r;(r=document.createElement("div")).setAttribute("class","inlineTop informerFore"),r.onclick=m,r.innerHTML=word.forecastButtonName,t.appendChild(r);var s=document.createElement("div");s.setAttribute("class","informerBoard inlineTop wavesBackGround");var d,h=e.query.results.channel;!function(t){var e=document.createElement("a");e.setAttribute("href",t.link),e.setAttribute("target","_blank"),e.setAttribute("style","text-align:center");var r=document.createElement("img");r.setAttribute("src",t.url),r.setAttribute("width",t.width),r.setAttribute("height",t.height),r.setAttribute("alt",t.title),r.setAttribute("class","informerImgBord logo right"),e.appendChild(r),s.appendChild(e)}(h.image),function(t,e){var r=(new Date).getHours(),n=(new Date).getMinutes()/100;r+=n;var o=h.astronomy.sunrise+"";o=1*(o=o.substring(0,o.indexOf(" ")).replace(":","."));var i=h.astronomy.sunset+"";i=12+1*(i=i.substring(0,i.indexOf(" ")).replace(":","."));var a=o<r&&r<i?"left imgDay informerImgBord":"left imgNight informerImgBord",l=t.substring(9,t.indexOf(">")+1);(d=document.createElement("div")).setAttribute("class",a),d.innerHTML=l,s.appendChild(d)}(h.item.description);var n=h.atmosphere,o=h.item.forecast;function i(t,e){var r=e?"\n":"&nbsp;",n=u(t.split(" ")[1],e);return e||(n=0<n.indexOf("ь")||0<n.indexOf("й")?n.substring(0,n.length-1)+"я":n+"а"),t.split(" ")[0]+r+n}return function(t,e){var r=e.date;r=u(e.day,!0)+"&nbsp;"+i(r,!1);var n=document.createElement("div");n.setAttribute("class","informerText");var o='<div><span class="informer labelColor"> '+r+'</span></div><span  class="informer labelColor">'+word["humid.label"]+" "+t.humidity+'&nbsp;%</span><br /><span  class="informer labelColor">'+word.pressure+"&nbsp;"+(t.pressure/1e3*750.0637+"").substring(0,3)+"&nbsp;"+word["baro.label"]+'</span><div style="margin-top: 0.3em;margin-bottom: 3px">&nbsp;<span  class="informerDay">'+word.day+": "+(5*(e.high-32)/9+"").substring(0,4)+' ℃ </span>&nbsp;<span class="informerNight">'+word.night+": "+(5*(e.low-32)/9+"").substring(0,4)+" ℃ &nbsp;</span></div>";n.innerHTML+=o,s.appendChild(n)}(n,o[0]),function(t){for(var e=0;e<t.length;e++){var r={};r.picture="http://l.yimg.com/a/i/us/we/52/"+t[e].code+".gif",r.max=Math.round(500*(t[e].high-32)/9)/100,r.min=Math.round(500*(t[e].low-32)/9)/100,r.date=u(t[e].day,!0)+" "+i(t[e].date,!0),c[e]=r}}(o),t.appendChild(s),{end:"yes"}},showForecast:m}}window.debug||(debug=!1);var chartBoard,serverRoot="http://"+window.location.host+"/";console.log("debug="+debug),debug&&console.log(" start test execution ON host:"+serverRoot),debug&&console.log("Browser: '"+navigator.userAgent+"'  "),function(){var t,e=new MeteoViewer,r=e.createDevPanel();e.createActivityPanel(document.getElementsByName("activityPanel")[0]);var n=setInterval(function(){t||4<o?(clearInterval(n),chartBoard=e.createChart(document.getElementById("graphCanvas")),4<o&&!debug&&alert(word.informerAlert)):yahooWeatherData?t=e.createInformer(document.getElementsByName("informer")[0],yahooWeatherData):console.log("Can`t get data from Yahoo Weather");o++},1e3),o=0;function i(){get(serverRoot+"current",a)}function a(t){t&&debug&&console.log("GET DATA:"+JSON.stringify(t));try{r.indoorTherm.setValue(t.tIn),r.hygrometer.setValue(t.humid),r.barometer.setValue(t.baro),r.outdoorTherm.setValue(t.tOut)}catch(t){console.log("in setDeviceValues ERROR\n"+t.name+" "+t.message)}}setTimeout(i,2500),setInterval(i,2e4)}(),function(){var o={},w=document.forms.checkDuration,l=w.elements.submitButton;l.setAttribute("disabled","disabled"),l.addEventListener("click",function(){var t,e,r,d=(n=M(w.elements.sensorSelect),o=k[n],o.name=n,o);var n,o;1===p.selectedIndex&&(t="lastValues?sensor="+d.name,get(t,function(t){var e,r,n,o,i,a,l,s;t?(e=d,r=t,a="    "+word.time,l=e.text,s={values:function(t){o=r.last,n=new Array(r[t].length),i=n.length;for(var e=0;e<i;e++)n[e]=r[t][e];for(o=i+o+1,e=0;e<i;e++)n[e]=r[t][(o+e)%i];return n}(e.name),xAxisLabels:function(){var t,e,r=new Date,n=[];r.setSeconds(r.getSeconds()-3900);for(var o=0;o<13;o++)r.setSeconds(r.getSeconds()+300),t=9<(t=r.getHours())?t:"0"+t,e=9<(e=r.getMinutes())?e:"0"+e,n[o]=t+":"+e;return n}()},L(a,e.yLabel,e.color,l,s,e.edges)):console.log("not get data")}));if(2===p.selectedIndex)if(r=M(y),0<C.selectedIndex){if(e=M(C),!function(t,e){var r=!0;(r=E.hasOwnProperty(t)&&E[t]instanceof Array)&&(r=0<=E[t].indexOf(e));return r}(r,e))return console.log('test.js: such interval NOT FOUND "'+r+"/"+e+'"'),void alert("Error");var i=r+"/"+e+".txt";N(i,function(t){A.selectedIndex<1?T(d,t):function(t,e,r){for(var n=e.split("\n"),o=[],i=[],a=0,l=n.length-1,s=0;s<l;s++)if(n[s]=n[s].trim(),!(n[s].length<3)){var d=n[s].split(/\s/),h=NaN;if(1<d[0].length){var u="0"===d[0].charAt(0)?Number(d[0].charAt(1)):Number(d[0]);u===r&&(0==a?d[1]:d[1],h=Number(d[t.numInData]),!isNaN(h)&&h>t.edges.min&&h<t.edges.max&&(o[a]=h,i[a]=d[1],a++))}else console.log("Error dayData is not String-'"+d[0]+"'  dayD[1]="+d[1])}var c=word.hour,m=C.getElementsByTagName("option")[C.selectedIndex].innerHTML;3<m.length&&(m=m.substr(0,3)+". ");var f=" "+t.text+word.by+r+" "+m+" "+M(y)+word.year,g=t.edges;o.length<1?L("","","red",word.noDataFor+f,[0,0,0,0,0,0],{min:-1,max:1}):o.length===i.length&&(o={values:o,xAxisLabels:i});L(c,t.yLabel,t.color,f,o,g)}(d,t,A.selectedIndex)})}else a=d,l=r,c=[],m=[],f=0,g=word.month,b=word.baro+word.by+l+word.year,v=!1,function(n,o){var i={};if(debug&&console.log("test.js [ start fill data for year "+n+" ]"),E.hasOwnProperty(n)){var a=E[n];a.length<1&&o(i);var l=0;!function e(t){var r=n+"/"+a[l]+".txt";N(r,function(t){t&&(i[a[l]]=t),++l==a.length?o(i):e(l)})}()}else o(i)}(l,function(t){if("{}"==JSON.stringify(t))return console.log("test.js(drawYearChart) - Get empty year data for "+l),alert(word.noDataFor+l),L("","","red","",[0,0,0,0,0],{min:-1,max:1}),1;var e,r;for(var n in t){for(console.log("parse montchs p="+n),v||(v=n),c[f]=shortWord[(n+"").toLowerCase()],s=t[n].split("\n"),h=s.length-1,e=u=0;e<h;e++)(r=Number(s[e].trim().split(/\s/)[a.numInData]))<a.edges.min||r>a.edges.max||(u+=r);m[f]=0<u?parseInt(u/(e+1)+.5001):parseInt(u/(e+1)-.5001),f++}if(1==c.length){debug&&console.log("test.js try draw year chart as Month");var o=C.getElementsByTagName("option");for(e=0;e<o.length;e++)-1<o[e].getAttribute("value").indexOf(v)&&o[e].setAttribute("selected","selected");N(l+"/"+M(C)+".txt",function(t){return T(a,t),!0})}return debug&&console.log("year chart: [ "+c+" ]     [ "+m+" ]"),1!=c.length&&L(g,a.yLabel,a.color,b,{values:m,xAxisLabels:c},a.edges),!1}),setTimeout((x=word.noDataFor+" "+a.text+word.by+l+word.year,void(f<1&&L("","","red",x,[0,0,0,0],{min:-1,max:1}))),6e3);var a,l,s,h,u,c,m,f,g,b,v,x});var p=w.elements.intervalSelect;p.addEventListener("click",function(){1==p.selectedIndex&&l.hasAttribute("disabled")&&l.removeAttribute("disabled");if(2==p.selectedIndex){var t=serverRoot+"availablePeriod";get(t,e),E&&(document.getElementsByName("fYearLabel")[0].style.color="#403030",document.getElementsByName("fMonthLabel")[0].style.color="#404030")}});var y=w.elements.yearSelect;y.addEventListener("click",function(){if(y.selectedIndex<1)return;for(var t=C.getElementsByTagName("option"),e=E[M(y)],r=1;r<t.length;r++)e.indexOf(t[r].getAttribute("value"))<0?t[r].setAttribute("disabled","disabled"):t[r].hasAttribute("disabled")&&t[r].removeAttribute("disabled");t[0].hasAttribute("disabled")&&t[0].removeAttribute("disabled");C.selectedIndex=0,A.selectedIndex=0,A.hasAttribute("disabled")||A.setAttribute("disabled","disabled");0<e.length&&(l.hasAttribute("disabled")&&l.removeAttribute("disabled"),C.hasAttribute("disabled")&&C.removeAttribute("disabled"))});var C=w.elements.monthSelect;C.addEventListener("click",function(){if(C.selectedIndex<1)return;N(M(y)+"/"+M(C)+".txt",function(t){t&&function(t){var e=t.split("\n");if(e.length<1)return;for(var r,n=[],o=-1,i=0,a=0;a<e.length;a++)(r=e[a].trim().split(/\s/)[0])!=o&&(n[i]=r,o=r,i++);var l,s=A.getElementsByTagName("option");for(A.selectedIndex=0,a=0;a<s.length;a++)(l=s[a].getAttribute("value"))<9&&(l="0"+l),n.indexOf(l)<0?s[a].setAttribute("disabled","disabled"):s[a].hasAttribute("disabled")&&s[a].removeAttribute("disabled");A.hasAttribute("disabled")&&A.removeAttribute("disabled");s[0].hasAttribute("disabled")&&s[0].removeAttribute("disabled")}(t)})});var A=w.elements.daySelect,t="sensorData?period=",k={tIn:{edges:{min:0,max:40},yLabel:word["tIn.label"],color:"#a85",text:word["tOut.text"],numInData:2},tOut:{edges:{min:-50,max:50},yLabel:word["tOut.label"],color:"#959",text:word["tOut.text"],numInData:3},baro:{edges:{min:600,max:800},yLabel:word["baro.label"],color:"gray",text:word["baro.text"],numInData:4},humid:{edges:{min:0,max:100},yLabel:word["humid.label"],color:"#46b",text:word["humid.text"],numInData:5}};C.addEventListener("click",function(){0<C.selectedIndex&&A.hasAttribute("disabled")&&(A.removeAttribute("disabled"),document.getElementsByName("fDayLabel")[0].style.color="#403030"),C.selectedIndex<1&&!A.hasAttribute("disabled")&&(A.setAttribute("disabled","disabled"),document.getElementsByName("fDayLabel")[0].style.color="#ac9999")});var M=function(t){return t.getElementsByTagName("option")[t.selectedIndex].getAttribute("value")},v=function(t){return t.getElementsByTagName("option")[t.selectedIndex].innerHTML};function T(t,e){debug&&console.log("drawMonthChart for sensor="+t.name+"  month="+M(C)+" data: \n "+e+"\n____EOF___");var r=e.split("\n"),n=r.length-1,o=v(C)+" "+M(y)+word.year,i=word.number;if(n<0)L("","","#f99",word.noDataFor+" "+t.text+word.by+o,[0,0,0,0,0,0,0],{min:-1,max:1});else{var a=[],l=[],s=r[0].trim().split(/\s/),d=s[0],h=1,u=Number(s[t.numInData]);(isNaN(u)||u<t.edges.min||u>t.edges.max)&&(u=0);for(var c=0,m=0,f=1;f<r.length;f++)if(d==(s=r[f].trim().split(/\s/))[0]){if(m=Number(s[t.numInData]),isNaN(m)||m>t.edges.max||m<t.edges.min)continue;u+=m,h++}else f<n?(l[c]=d,a[c]=u<0?parseInt(u/h-.5001):parseInt(u/h+.5001),d=s[0],u=Number(s[t.numInData]),h=1,c++):(l[c]=d,a[c]=u<0?parseInt(u/h-.5001):parseInt(u/h+.5001));if(0!=c){var g=" "+t.text+word.by+o,b={values:a,xAxisLabels:l};L(i,t.yLabel,t.color,g,b,t.edges)}else L(i,"     ",t.color,word.by+d+"/"+o+" "+word.meanFor+t.text+" = "+a[0],[0,0,0,0],{min:-1,max:1})}}function L(t,e,r,n,o,i){chartBoard.setAxisLabels(t,e),chartBoard.chartColor(r),chartBoard.create(n,o,i)}var E={};function e(t){var e;if(t&&t instanceof Array&&!(t.length<1)){var r,n="",o=0;for(var i in t){var a=t[i].substring(6,10);debug&&i<1&&console.log("First year = "+a),n!=a?(""!=n&&s(n,r),r=[],n=a,o=0):o++,e=t[i].substring(11,14),r[o]=e}""!=n&&s(n,r),debug&&console.log("availablePeriods: "+JSON.stringify(E)),function(){for(var t=y.getElementsByTagName("option"),e=!1,r=0;r<t.length;r++)E[t[r].getAttribute("value")]?(t[r].hasAttribute("disabled")&&t[r].removeAttribute("disabled"),e||(y.selectedIndex=r,e=!0)):t[r].setAttribute("disabled","disabled");C.selectedIndex=0,(A.selectedIndex=0)<t.length&&(l.hasAttribute("disabled")&&l.removeAttribute("disabled"),y.hasAttribute("disabled")&&y.removeAttribute("disabled"))}()}else E={}}function s(t,e){E[t]=e}function N(r,n){o.hasOwnProperty(r)?(debug&&console.log("get data from cache"),n(o[r])):(debug&&console.log("test.js try get data from server"),get(t+r,function(t){if(t){var e=function(t){var e,r="",n=t.split("\n");if(n.length<1)return!1;for(var o=0;o<n.length;o++)-1<n[o].search(/[^\s\d-]/)||6==(e=n[o].trim().split(/\s/)).length&&(isNaN(e[2])||1e3<e[2]||e[2]<-1e3||isNaN(e[3])||1e3<e[3]||e[3]<-1e3||isNaN(e[4])||1e3<e[4]||e[4]<-1e3||isNaN(e[5])||1e3<e[5]||e[5]<-1e3||(r+=n[o]+"\n"));return!(r.length<14)&&r}(t);e?function(t,e){if(o.hasOwnProperty(t))return;o[t]=e}(r,e):console.log("test.js [ GET WRONG DATA FOR PERIOD "+r+" ] "),n(e)}else console.log("test.js [ GET EMPTY DATA FOR PERIOD "+r+" ] "),n(!1)}))}}();
