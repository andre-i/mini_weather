function Measurer(e,t){"use strict";var r=!1,n="http://www.w3.org/2000/svg",o=navigator.userAgent.toLowerCase(),i=!(o.search("firefox")<0);i&&o.substring(o.length-4)>58.9&&(i=!1);var a,l={strokeCol:"#744",devBordStartCol:"#eef",devBordStopCol:"#851",fill:"#ffe",textCol:"#332",brightnessCol:"#fff",devBorderCol:"#530",labelCol:"#322",scaleCol:"red",scaleBordCol:"#132",arrStrokeCol:"#010",arrFillCol:"#864"},s={minValue:0,maxValue:100,scaleDivideCount:10},d={height:Math.round(.36*u()),width:Math.round(.12*u()),curValue:0,strokeWidth:1,hasScaleLabels:!0,hasLabel:!0,hasEdgeCircle:!0,hasGlass:!0,hasRoundRect:!0,label:""},h={label:"",alpha:0,startAngle:0,stopAngle:180,width:Math.round(u()/4.1),strokeWidth:1,hasRound:!0};function u(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight,document.body.offsetHeight,document.documentElement.offsetHeight,document.body.clientHeight,document.documentElement.clientHeight)}var c=(Math.random()*(new Date).getSeconds()+"").substring(0,6),m=document.createElement("div"),f=document.createElement("div");f.appendChild(m),f.setAttribute("class","bigSize");var g,b=document.getElementsByTagName("body")[0];var v={};if(t){if(null==e||!(e instanceof HTMLElement))return console.log(" new created device has no owner container(tag) i get - "+e),void(g=null);g=null,function(){var e;for(var r in t.hasOwnProperty("bounds")&&(e=t.bounds),s)e&&e.hasOwnProperty(r)?v[r]=e[r]:v[r]=s[r]}(),function(){var e;for(var r in t.hasOwnProperty("colors")&&(e=t.colors),l)e&&e.hasOwnProperty(r)?v[r]=e[r]:v[r]=l[r]}(),v.owner=e,t.hasOwnProperty("rect")&&(!function(){var e=t.rect;for(var r in d)e&&e.hasOwnProperty(r)?v[r]=e[r]:v[r]=d[r];e&&e.hasOwnProperty("fontSize")&&(d.fontSize=e.fontSize),e&&e.hasOwnProperty("scaleWidth")&&(d.scaleWidth=e.scaleWidth)}(),g=function(e){var t,n,o,i,l,s,d,h,u=!1,c=0,g=null,v=null,x=null,w=null,p=0,y=!1;function C(t){if(null==w)return!1;if(t>e.maxValue||t<e.minValue)return console.log("WARNING linearDevice get wrong current value "+t),M(p="ERR"),!1;p=t;var r=(t-=e.minValue)*o/Math.abs(e.minValue-e.maxValue),n=""+(l-r);return w.setAttribute("y",n),w.setAttribute("height",""+r),y&&M(p),!0}function A(e){y=e,M(e?p:"?")}function k(t){n=e.hasOwnProperty("scaleWidth")?Math.round(e.scaleWidth*e.width/100):Math.round(e.width/10),l=Math.round(.87*e.height),s=Math.round(.12*e.height),o=l-s,i=(l-s)/e.scaleDivideCount,h=e.height/40,e.strokeWidth=Math.round(e.height/200),h<2&&(h=2),d=Math.round(e.width/2-h),c=o/e.scaleDivideCount-4*e.strokeWidth,t&&c<8&&(c=8)}function M(e){return null!=x&&(x.textContent=""+e,!0)}var T,L,E=!1;function N(){r&&console.log("CALL flip on linearDevice"),E?E&&(f.parentNode.removeChild(f),m.innerHTML="",e.height=T,e.width=L,c=a,k(!0),O(e.owner),C(p),E=!1):E||(b.appendChild(f),a=c,T=e.height,L=e.width,e.height=Math.round(.85*document.body.clientHeight),e.width=Math.round(L*e.height/T),k(!0),m.setAttribute("style","height:"+e.height+"px;padding-top:"+3*e.height/34+"px;"),O(m),C(p),E=!0)}function B(){A(!y)}function O(t){var r,a,m;u?(m=e.width,a=e.height,r=" transform='rotate(90) translate(0, -"+e.height+")' >"):(m=e.height,a=e.width,r=" >"),t.innerHTML="<svg width='"+a+"' height='"+m+"' viewBox='0,0 "+a+" "+m+"' xmlns='http://www.w3.org/2000/svg'></svg>",g=t.getElementsByTagName("svg")[0];var f,b,p,y,C,A,k,M,T,L,E,O,I,D,S,W,H,P="<g id='"+e.id+"group' "+r;return P+=function(){e.gradId=e.brightnessId+"Rgrad";var t="<defs> <radialGradient id='"+e.gradId+"' cx='50%' cy='50%' > ";return t+=" <stop offset='25%' stop-color='"+e.devBordStartCol+"' opacity='0.5' />",t+=" <stop offset='75%' stop-color='"+e.devBordStartCol+"'/>",t+="  <stop offset='99%' stop-color='"+e.devBordStopCol+"'  />",t+="</radialGradient>"}(),P+="<linearGradient  id='"+e.id+"scale' x1='0' y1='0' x2='100%' y2='0' ><stop offset='0%' stop-color='black' stop-opacity='0.5' /><stop offset='37%' stop-color='#fff' stop-opacity='0.2' /><stop offset='45%' stop-color='#fff' stop-opacity='0.4' /><stop offset='55%' stop-color='#fff' stop-opacity='0.2' /><stop offset='100%' stop-color='black' stop-opacity='0.6' /></linearGradient></defs> ",P+=(S=e.strokeWidth,W=e.height-e.strokeWidth,H="",e.hasRoundRect&&(H=" rx='"+2*h+"' ry='"+2*h+"' "),"<rect name='housing' x='"+S+"' y='"+S+"'  width='"+(e.width-2*e.strokeWidth)+"' height='"+(e.height-2*e.strokeWidth)+"' "+H+" stroke='"+e.devBorderCol+"' stroke-width='"+1.3*e.strokeWidth+"' fill='"+e.devBordStartCol+"' /><line x1='"+2*h+"' y1='"+S+"' x2='"+(e.width-2*h)+"' y2='"+S+"' stroke='"+e.devBorderCol+"' stroke-width='"+e.strokeWidth+"' /><line x1='"+2*h+"' y1='"+W+"' x2='"+(e.width-2*h)+"' y2='"+W+"' stroke='"+e.devBorderCol+"' stroke-width='"+e.strokeWidth+"' />"),P+=(f="<rect ",f+=" name='brightness' x='"+(d-c)+"' y='"+(s-c/2)+"'  width='"+2*c+"' height='"+(o+c)+"'  rx='"+c/2+"' ry='"+c/3+"' opacity='0.4' fill='"+e.brightnessCol+"' />"),e.hasLabel&&(P+=(O=" ",I=1.2*h,D=(E=o/10-h/2)+h/2,u&&(O=" transform='rotate(-90 "+D+" "+D+") translate( -"+o+" , -"+2*e.strokeWidth+")' "),"<text name='housing'  x='"+I+"' y='"+D+"' fill='"+e.labelCol+"' "+O+" font-size='"+E+"' >"+e.label+"</text>")),P+=(b="<rect ",b+=" x='"+(d-n/2)+"' y='"+(s-e.strokeWidth/2)+"'  width='"+n+"' height='"+(o+e.strokeWidth)+"'  stroke='"+e.scaleBordCol+"' stroke-width='"+e.strokeWidth+"'  fill='none' /> "),e.hasEdgeCircle&&(P+=(L="<circle r='"+(M=.9*n)+"' cx='"+d+"' cy='"+(T=l+M)+"'  stroke='"+e.scaleBordCol+"' stroke-width='"+e.strokeWidth+"'  fill='"+e.scaleCol+"' />",e.hasGlass&&(L+="<circle r='"+(M-e.strokeWidth/2)+"' cx='"+d+"' cy='"+T+"'   fill='url(#"+e.id+"scale)' />"),L+="<rect  x='"+(d-n/2+e.strokeWidth/2)+"' y='"+l+"'  width='"+(n-e.strokeWidth)+"' height='"+1.3*e.strokeWidth+"'  fill='"+e.scaleCol+"' /> ")),P+=function(){for(var t,r=d+n/2+e.strokeWidth,o=d+n/2+e.width/7,a="",l=2*e.scaleDivideCount+1,h=i/2,u=0;u<l;u++)a+=" <line x1='"+r+"' y1='"+(t=s+u*h)+"'' x2='"+(o-u%2*c/3)+"' y2='"+t+"' stroke='"+e.strokeCol+"' stroke-width='"+e.strokeWidth+"' /> ";return a}(),e.hasScaleLabels&&(P+=function(){var t,r=0,o=d+n/2+e.width/7+.8*c;if(c<10)return"<text x='"+(t=o)+"' y='"+(l+7)+"' font-size='14' fill='"+e.strokeCol+"' >"+e.minValue+"</text> <text x='"+t+"' y='"+(s+4)+"' font-size='14' fill='"+e.strokeCol+"' >"+e.maxValue+"</text> ";for(var a=l+e.strokeWidth/2,h=(e.maxValue-e.minValue)/e.scaleDivideCount,m="' fill='"+e.textCol+"' font-style='plain'  text-anchor='middle'",f="",g=0;g<e.scaleDivideCount+1;g++){var b=Math.round(10*(e.minValue+h*g))/10;f+="<text name='housing'  x='"+o+"' y='"+(r=a-g*i)+"' "+m,u&&(f+=" transform='rotate(-90 "+o+" "+r+")' "),f+=0==b?" font-weight='bold' font-size='"+(c+2*e.strokeWidth)+"' >":" font-size='"+c+"' >",f+=b+"</text>"}return f}()),P+="<rect name='scale'  x='"+(d-n/2+e.strokeWidth/2)+"' y='"+(l-e.strokeWidth)+"'  width='"+(n-e.strokeWidth)+"' height='0' fill='"+e.scaleCol+"' />",e.hasGlass&&(P+=(k=d-n/2,A=e.hasRound?o+2.3*e.strokeWidth:o+1.5*e.strokeWidth,"<rect x='"+k+"' y='"+s+"' width='"+n+"' height='"+A+"' fill='url(#"+e.id+"scale)' />")),P+=(p=o/10-h/2,y=e.height-p-h/2-2*e.strokeWidth,C="<rect x='"+(3*e.width/4-1.2*p)+"' y='"+y+"'  width='"+2.15*p+"' height='"+p+"'  fill='"+e.devBordStartCol+"'  stroke='"+e.strokeCol+"'  stroke-width='"+e.strokeWidth+"' opacity='1' /><text  name='text'' x='"+(3*e.width/4-e.strokeWidth)+"' y='"+(e.height-h-e.strokeWidth)+"' text-anchor='middle' fill='"+e.textCol+"' font-size='"+p+"' >?</text>",C+="<rect name='valuesPane' x='"+(3*e.width/4-1.1*p)+"' y='"+(y+e.strokeWidth)+"'  width='"+2*p+"' height='"+(p-2*e.strokeWidth)+"'  fill='"+e.devBordStartCol+"' opacity='0.1' />"),g.innerHTML=P+"</g>",function(){for(var e,t=g.childNodes[0],r="",n=0;n<t.childNodes.length;n++){e=t.childNodes[n];try{e instanceof Text||!e.hasAttribute("name")||("scale"==(r=e.getAttribute("name"))&&(w=e),"brightness"==r&&(e.addEventListener("click",N),v=e),"text"==r&&(x=e),"valuesPane"==r&&e.addEventListener("click",B),"housing"==r&&e.addEventListener("click",N))}catch(e){}}}(),!0}var I=!1;return function(){var r;if(t=e.brightnessCol,e.width%5!=0){for(r=Math.round(e.width);r%6!=0;)r++;e.width=r}if(!function(){var t=!0;if(e.hasOwnProperty("scaleWidth")){var r=e.scaleWidth;(r!=r||Math.abs(r-100)>91)&&(t=!1)}if(e.hasOwnProperty("fontSize")&&(c!=c||c<8||c>100))return!1;if((e.height!=e.height||e.height<10||e.width!=e.width||e.width<10||e.strokeWidth!=e.strokeWidth||e.strokeWidth<1||e.maxValue!=e.maxValue||e.minValue!=e.minValue||e.scaleDivideCount!=e.scaleDivideCount||e.scaleDivideCount<1)&&(t=!1),!t)throw console.log("ERROR : wrong start parameter"),new Error("Illegal value og parameter");return t}())throw I=!0,new Error("init param wrong");if(e.height<=e.width){var n=e.width;e.width=e.height,e.height=n,u=!0}k(!1),O(e.owner),I=!1}(),I?null:{setValue:C,brightness:function(t){return null!=v&&(v.setAttribute("fill",t),e.brightnessCol=t,!0)},getBrightness:t,showValue:A}}(v)),t.hasOwnProperty("oval")&&(!function(){var e=t.oval;for(var r in h)e.hasOwnProperty(r)?v[r]=e[r]:v[r]=h[r];e.hasOwnProperty("fontSize")&&(h.fontSize=e.fontSize),e.hasOwnProperty("hasRound")&&0==e.hasRound&&(v.width=Math.round(v.width+v.width/10))}(),g=function(e){var o,l,s=40,d=null,h=null,u=null,g=void 0,v=!1,x=0,w=!1,p=0;function y(e){w=e,C(e?p:"?")}function C(e){return null!=u&&(u.textContent=e,!0)}function A(){v?v&&(f.parentNode.removeChild(f),m.innerHTML="",e.width=x,l=a,M(e.owner),v=!1):function(){if(!v){b.appendChild(f),a=l,x=e.width;var t=document.body.clientHeight,r=document.body.clientWidth;e.width=r>t?Math.round(.85*t):Math.round(.85*r),l=l*e.width/x,g.innerHTML="<svg  width='"+e.width+"' height='"+e.width+"' viewBox='0,0 "+e.width+" "+e.width+"' xmlns='http://www.w3.org/2000/svg'></svg>",m.setAttribute("style","padding-top:"+(t-e.width)/2+"px; height: "+e.width+"px;"),M(m),v=!0}}()}function k(){y(!w)}function M(t){var r=e.hasRound?e.width:.9*e.width;t.innerHTML="<svg  width='"+e.width+"' height='"+r+"' viewBox='0,0 "+e.width+" "+e.width+"' xmlns='http://www.w3.org/2000/svg'></svg>",(g=t.getElementsByTagName("svg")[0]).innerHTML="";var o,a,c,m,f,b,v,x,y,C,M,E,N,B,O,I,D,S=function(){e.gradId=e.brightnessId+"Cgrad";var t="<defs> <radialGradient id='"+e.gradId+"' cx='50%' y='30%'> ";return t+=" <stop name='brightness' offset='5%' stop-color='"+e.brightnessCol+"' /> <stop offset='25%' stop-color='"+e.brightnessCol+"'  /> <stop offset='45%' stop-color='"+e.fill+"' /> <stop offset='93%' stop-color='"+e.fill+"' /> <stop offset='98%' stop-color='"+e.devBordStartCol+"' /> </radialGradient> </defs> <defs><radialGradient id='"+e.gradId+"1' cx='50%' y='50%'> ",t+=" <stop offset='80%' stop-color='"+e.devBordStartCol+"'/>",t+="  <stop offset='90%' stop-color='"+e.devBordStopCol+"'  />",t+="  <stop offset='93%' stop-color='"+e.devBordStopCol+"'  />",t+=" <stop offset='98%' stop-color='"+e.devBordStartCol+"' />",t+=" <stop offset='100%' stop-color='"+e.devBordStartCol+"'  />",t+="</radialGradient> </defs>"}()+(o="<ellipse name='flip' ",a=e.width/2-e.strokeWidth,c=e.hasRound?a:.43*e.width,o+=" cx='"+e.width/2+"' cy='"+e.width/2+"'  rx='"+a+"' ry='"+c+"' stroke='"+e.devBorderCol+"' stroke-width='"+2*e.strokeWidth+"'  fill='url(#"+e.gradId+"1)' /> <ellipse cx='"+e.width/2+"' cy='"+e.width/2+"'  rx='"+a+"' ry='"+c+"' stroke='"+e.devBorderCol+"' stroke-width='"+2*e.strokeWidth+"'  fill='none' /> ");S+=function(t,r,n,o,i,a){(t!=t||t<1||t>50)&&(t>50&&(t=50),t<1&&(t=1),console.log('WARNING gigro: "radius oval`s must be digits in percents (from 1 to 50)" '));var l="<circle  name='flip' ";null==r&&(r=e.strokeCol),null==n&&(n=e.strokeWidth),null==o&&(o="none"),null==i&&(i=e.width/2),null==a&&(a=e.width/2);for(var s=[Math.round(e.width*t/100)-n,i,a,r,n,o],d=0;d<6;d++)l+=T[d]+s[d];return l+="' /> "}(s,void 0,2*e.strokeWidth,"url(#"+e.gradId+")"),S+=function(){for(var t="",r=(e.stopAngle-e.startAngle)/e.scaleDivideCount,n=e.width/2+2*e.strokeWidth-Math.round(s*e.width/100),o=n+Math.round(s*e.width/650),i=e.width/2,a=e.width>400?4*e.strokeWidth:5*e.strokeWidth/3,l=0;l<=e.scaleDivideCount;l++)t+=L(!0,n,i,o,i,e.startAngle+l*r,e.strokeCol,a);if(r>10){o=n+(o-n)/2,r/=5,a/=2;var d=5*e.scaleDivideCount+1;for(l=0;l<d;l++)t+=L(!0,n,i,o,i,e.startAngle+l*r,e.strokeCol,a)}return t}(),S+=function(){for(var t,r,n=(e.stopAngle-e.startAngle)/e.scaleDivideCount,o=s*e.width/150,a=i?l/2.4:l/2,d=" ",h=e.scaleDivideCount+1,u=0,c=s*e.width/100>80,m=e.scaleDivideCount>14,f=0;f<h;f++){var g=Math.PI/180*(e.startAngle+f*n);if(0!=f&&f!=e.scaleDivideCount||(u=a/4),0==f||f==e.scaleDivideCount||c){if(m&&f%2!=0)continue;t=Math.round(e.width/2-o*Math.cos(Math.PI/180+g)),r=Math.round(e.width/2-o*Math.sin(Math.PI/180+g)),d+="<text name='flip' text-anchor='middle' font-size='"+(a+u)+"' ",d+=" fill='"+e.textCol+"' x='"+t+"' y='"+r+"' >",d+=e.minValue+f*Math.round((e.maxValue-e.minValue)/e.scaleDivideCount)+"</text>"}}return d}(),S+=(m=i?"50%":"0%",f=i?l/1.42:l/1.3,b=e.width*s/220,v=e.width/2,x=4*e.width/7,"<defs> <path  id='"+e.id+"labelPath'  d='M "+(v-b+l/6)+", "+(x+l/5)+" C "+(v-b+l/2)+", "+x/2+" "+(v+b-l/2)+", "+x/2+" "+(v+b-l/4)+", "+x+"' /> </defs><text  x='"+(v-b-l/6)+"' y='0%'  font-size='"+f+"' fill='"+e.labelCol+"'  text-anchor='middle' > <textPath xlink:href='#"+e.id+"labelPath' startOffset='"+m+"' >"+e.label+"</textPath></text> "),S+=(y=w?p:"?",C=1.4*l,M=Math.round(C/4),E=Math.round(e.width*(.5+3*s/400)),N="<rect x='"+(e.width/2-1.1*C)+"' y='"+(E-3.2*M)+"'  width='"+2.2*C+"' height='"+(C-.2*M)+"'  stroke='"+e.devBorderCol+"' stroke-width='"+M/5+"'  fill='"+e.devBordStartCol+"' />",N+="<text x='"+e.width/2+"' y='"+E+"'  name='text' text-anchor='middle' opacity='0.8'  font-size='"+C+"' fill='"+e.textCol+"' >"+y+"</text> ",N+="<rect name='valuesPane' x='"+(e.width/2-1.15*C)+"' y='"+(E-3.25*M)+"'  width='"+2.1*C+"' height='"+(C-.3*M)+"'  fill='"+e.devBordStartCol+"' opacity='0.1' />"),S+=(B=e.width/2,O=e.width/2,I=e.width>400?s/3:s/6,D="<polygon name='arrow' ",D+=" points='"+(B+2*I)+","+O+" "+(B+3*I)+","+(O+I)+" ",D+=B-Math.round(s*e.width/110)+","+O+" "+(B+3*I)+","+(O-I)+"' ",D+=" stroke='"+e.arrStrokeCol+"' stroke-width='"+2*e.strokeWidth/3+"' ",D+=" transform='rotate("+e.alpha+" "+B+" "+O+")' fill='"+e.arrFillCol+"' /> ",D+="<circle r='"+I/4+"' cx='"+B+"' cy='"+O+"' fill='black' />"),g.innerHTML=S,function(){for(var e=g.getElementsByTagNameNS(n,"stop"),t=0;t<e.length;t++)e[t].hasAttribute("name")&&"brightness"==e[t].getAttribute("name")&&(d=e[t]);d.addEventListener("click",A);var r,o="";for(t=0;t<g.childNodes.length;t++){r=g.childNodes[t];try{!(r instanceof Text)&&r instanceof Node&&r.hasAttribute("name")&&("arrow"==(o=r.getAttribute("name"))&&(h=r),"text"==o&&(u=r),"flip"==o&&r.addEventListener("click",A),"valuesPane"==o&&r.addEventListener("click",k))}catch(e){console.log(e)}}}()}var T=[" r='","' cx='","' cy='","', stroke='","' stroke-width='","' fill='"];function L(t,r,n,o,i,a,l,s){null==l&&(l=e.strokeCol),null==s&&(s=e.strokeWidth);var d="<line ";return null==o&&(o=e.width/2),null==i&&(i=e.width/2),d+="x1='"+r+"' y1='"+n+"' x2='"+o+"' y2='"+i+"' ",d+=" stroke='"+l+"' stroke-width='"+s+"' ",null!=a&&0!=a&&(d+=" transform='rotate("+a,d+=t?", "+e.width/2+", "+e.width/2+")' ":")' "),d+=" /> "}var E=!1;return function(){e.owner.innerHTML="",o=e.brightnessCol;try{e.width=Math.round(e.width),e.width%2!=0&&e.width++,x=e.width,E=function(){if(e.hasOwnProperty("fontSize")){var n=t.fontSize;if(n!=n||n<8||n>100)return console.log("ERROR Illegal start parameter fontSize it must be from 8 to 100"),!1;l=n}else(l=Math.round(e.width*s/340))<8&&(l=8);return r&&console.log("ovalDevice on start fontSize="+l),!0}(),e.id=c,e.brightnessId=c+"brigID",M(e.owner)}catch(e){throw console.log("measurer.js - ERROR on start device: "+e.toString()),console.log("ON START DEVICE I have parameters:"),E=!1,e}}(),E?{flip:A,setValue:function(t){if(null==h)return!1;if(t!=t||t<e.minValue||t>e.maxValue)return console.log("WARNING out of bounds leave: ("+e.maxValue+" - "+e.minValue+")  i get: "+t),C(p="ERR"),!1;e.alpha=e.stopAngle-(e.stopAngle-e.startAngle)*(e.maxValue-t)/(e.maxValue-e.minValue);var r="rotate("+e.alpha+" "+e.width/2+" "+e.width/2+")";return h.setAttribute("transform",r),p=t,w&&C(p),!0},brightness:function(t){return null!=d&&(d.setAttribute("stop-color",t),e.brightnessCol=t,!0)},getBrightness:o,showValue:y}:null}(v))}return r&&console.log("retDev="+g),g}function Plotter(e,t,r,n){if(null==e&&!(e instanceof HTMLElement))return console.log("'painter' parameter must be HTML container. I get: "+e),null;if(t!=t||r!=r||t<40||r<40)return console.log("plotter.js:  WARNING wrong width or height parameters"),null;var o,i,a,l,s,d,h={borderCol:"#623",bgCol:"#faf9e5",axisCol:"#541",labelCol:"#255"},u=e,c=Math.round(r/100),m=Math.round(r/250);m<1&&(m=1);var f,g,b,v=!1,x="#776",w=m,p=!1,y={},C=Math.round(r/25),A="",k="";function M(e,n,u){if(!n||!(n instanceof Array)&&!n.hasOwnProperty("values")||n.length<1)return console.log("plotter.js buildGraph [wrong parameter:second parameter must be array with numerical values or object with values and labels(see plotter.js function buildGraph]"),!1;if("string"!=typeof e)return console.log("buildGraph [wrong parameter: first parameter must be string values"),!1;if(f=e,n instanceof Array)g=n,p=!1;else{if(!(n.values instanceof Array&&n.values.length>0))return console.log('(plotter.js)Error First member object toDraw must have name "values" and contains array of numerical values'),!1;g=n.values,p=!!(n.hasOwnProperty("xAxisLabels")&&n.xAxisLabels instanceof Array&&n.xAxisLabels.length==n.values.length)&&n.xAxisLabels}!function(e){var t={};e&&e.hasOwnProperty("min")&&e.hasOwnProperty("max")?(t.min=e.min,t.max=e.max):(t.min=g[0],t.max=g[0],g.forEach(function(e){return e!=e?(console.log("array for chart contains not numbers:"+e),!1):(t.min>e&&(t.min=e),t.max<e&&(t.max=e),!0)}),t.min==t.max&&(0==t.min?(t.max=10,t.min=-10):(t.max=t.max>0?2*t.max:t.min,t.min=t.min<0?2*t.min:t.min)));y.min=t.min,y.max=t.max}(u);var b,E,B,I,D,S,W,H,P,V,R=function(){var e,t={},r=Math.abs(y.min-y.max),n=0,o=0,i=(r=r>4&&r<10.1?11:r)<10?-1:1;for(;!((e=r/Math.pow(10,i*n))<101&&e>10);)n++;if(n*=i,t.pow=n,(e=Math.round(e)+1)<=31)o=e,e=Math.pow(10,n);else if(e<=61){for(;e%2!=0;)e++;o=e/2,e=2*Math.pow(10,n)}else if(e<91){for(;e%3!=0;)e++;o=e/3,e=3*Math.pow(10,n)}else o=25,e=4*Math.pow(10,n);return t.count=o,t.vOd=e,t.ySpace=(a-s)/(o+2),function(e){var t=0;if(y.max<0){for(;y.max+e.vOd*t<0;)t++;e.startDash=e.count+t-1,e.xAxisPos=a-(e.count+1)*e.ySpace}else if(y.min>0){for(;y.min+t*e.vOd>0;)t--;e.startDash=t+1,e.xAxisPos=a}else if(y.max>=0&&y.min<=0){for(;y.min+e.vOd*t<0;)t++;e.startDash=t,e.xAxisPos=a-t*e.ySpace}}(t),t}(),z=(l-i-3*c)/(g.length+1);return b=g.length,E=z,B=R,o.innerHTML="",T(),P=i+","+(a+c)+" "+i+","+(s+d)+" "+(i-c)+","+(s+d)+" "+i+","+s+" "+(i+c)+","+(s+d)+" "+i+","+(s+d),o.innerHTML+="<polyline  points='"+P+"' stroke='"+h.axisCol+"'  stroke-width='"+m+"'  />",W=B.xAxisPos,H=i-c+","+W+" "+(l-d)+","+W+" "+(l-d)+","+(W-c)+" "+l+","+W+" "+(l-d)+","+(W+c)+" "+(l-d)+","+W,o.innerHTML+="<polyline points='"+H+"' stroke='"+h.axisCol+"' ' stroke-width='"+m+"' />",function(e){if(r<260)return 0;var t,n="",a=i+C/3,s=e.count+2,d=e.startDash;d>s?(d=s,L(Math.round(e.xAxisPos+e.ySpace/2)),N(e,(1-e.startDash)*e.vOd,1)):d<0?(d=0,L(Math.round(e.xAxisPos-e.ySpace/2)),N(e,(1-e.startDash)*e.vOd,1)):N(e,0,e.startDash);for(var u=0;u<s;u++)t=e.xAxisPos-(u-d)*e.ySpace,n+="<line x1='"+i+"' y1='"+t+"' x2='"+a+"'  y2='"+t+"'  stroke-width='"+m/2+"' stroke='"+h.axisCol+"'  fill='black' />",n+="<line x1='"+i+"' y1='"+t+"' x2='"+l+"' y2='"+t+"'  stroke-width='"+m/5+"' stroke='#ccc'  fill='#fff' />";o.innerHTML+=n}(B),I=B.xAxisPos,D="<text  x ='"+(i+2*c)+"' y='"+(s+d)+"'  font-size='"+C+"' text-anchor='start'  fill='"+h.labelCol+"' >"+k+"</text>",S="<text  x='"+(t-d)+"' y='"+(I+(r-I>2*C?1.5*C:-.2*C))+"' ' text-anchor='end' fill='"+h.labelCol+"'  font-size='"+C+"' >"+A+"</text>",o.innerHTML+=S+D,function(e,t,r){for(var n,l="",d=r<=s?r+C/3:r-C/3,u=a-2*c,f=s+2*c,g=1;g<e;g++)l+="<line x1='"+(n=i+g*t)+"' y1='"+r+"'  x2='"+n+"' y2='"+d+"'  stroke='"+h.axisCol+"' stroke-width='"+m/2+"' /> ",l+="<line x1='"+n+"' y1='"+u+"'  x2='"+n+"' y2='"+f+"'  stroke='#ccc' stroke-width='"+m/5+"' /> ";p&&function(e,t){var r=p.length,n=C-c;n<10&&(n=C);var l=t+n>a?t-C/3:t+1.2*n,s=1;r>20?s=3:r>10&&(s=2);for(var d='<text x="'+i+'" y="'+l+'"  font-size="'+n+'"  fill="'+h.labelCol+'" >'+p[0]+"</text>",u=1;u<r;u++)u%s==0&&(d+='<text x="'+(i+u*e)+'" y="'+l+'"  font-size="'+n+'" text-anchor="middle" fill="'+h.labelCol+'" >'+p[u]+"</text>");o.innerHTML+=d}(t,r),o.innerHTML+=l}(b,E,B.xAxisPos),V=f,o.innerHTML+="<text x='"+t/2+"' + y='"+1.2*C+"'  font-size='"+C+"' text-anchor='middle' fill='"+h.labelCol+"' style='font-style:italic;text-decoration:underline;' ' >"+V+"</text>",function(e,t,r){var n,l,s,d=" fill='"+h.bgCol+"' stroke='"+x+"' stroke-width='"+w+"' />",u=1.2*m,c=r.ySpace,f=a-r.startDash*c,g=c/r.vOd,b=i,p="<g name='chart'>",y=1;e.length>20?y=4:e.length>15?y=3:e.length>10&&(y=2);for(s=1;s<e.length;s++)O(e[s-1],e[s])?(n=f-g*e[s-1],l=f-g*e[s],p+="<line x1='"+b+"' y1='"+n+"' x2='"+(b+t)+"' y2='"+l+"' "+d,v&&s%y==0&&(p+="<circle cx='"+b+"' cy='"+n+"' r='"+u+"' "+d,p+="<text x='"+b+"' y='"+(n-4*m)+"' text-anchor='middle'  fill='black' font-size='"+C+"' >"+e[s-1]+"</text>"),b+=t):b+=t;e.length<2&&(l=f-g*e[0]);p+="<circle cx='"+b+"' cy='"+l+"' r='"+u+"' "+d,v&&(p+="<text x='"+b+"' y='"+(l-4*m)+"' text-anchor='middle'  fill='black' font-size='"+C+"' >"+e[s-1]+"</text>");p+="</g>",o.innerHTML+=p}(g,z,R),function(){var e=v?"-":"+";o.innerHTML+='<text x="'+(l-C/2)+'" y="'+(.9*C+c)+'"  font-size="'+(C+2*m)+'" font-weight="bold" text-anchor="middle" fill="#065" >'+e+'</text><rect name="toggle" x="'+(l-C)+'" y="'+c+'" width="'+C+'" height="'+C+'" fill="white" opacity="0.5" stroke="'+h.borderCol+'"  stroke-width="'+m/3+'" />';for(var t=0;t<o.childNodes.length;t++){var r=o.childNodes[t];r instanceof Text||!r.hasAttribute("name")||"toggle"!=r.getAttribute("name")||(r.onclick=function(){return v=!v,M(f,{values:g,xAxisLabels:p},y),0})}}(),!0}function T(){o.innerHTML="<rect name='border' x='"+(c-2)+"' y='"+(c-2)+"'   rx='"+4*m+"' ry='"+4*m+"'  height='"+(r+4)+"' width='"+(t+4)+"' stroke='"+h.borderCol+"' stroke-width='"+m+"' fill='"+h.bgCol+"' />"}function L(e){var t,r=d,n=1.4*d;for(t='<path d="';r<l;)t+="M"+r+","+e+" L"+(r+n)+","+e+" ",r+=2*d;t+='" stroke="#ec0" stroke-width="'+2*m+'" />',o.innerHTML+=t}function E(e){return"string"==typeof e&&e.length>4?i+2.5*C:i-3*m}function N(e,t,r){var n=B(e,t+e.vOd),i=B(e,(e.count-e.startDash)*e.vOd);t=B(e,t);var l=a-e.ySpace*r+C/3,s=a-e.ySpace*e.count+C/3,d=' fill="'+h.labelCol+'" font-size="'+C+'" text-anchor="end" ',u='<text x="'+E(t)+'" y="'+l+'" '+d+" >"+t+'</text><text x="'+E(n)+'" y="'+(l-e.ySpace)+'" '+d+" >"+n+"</text>";o.innerHTML+=u,u='<text x="'+E(i)+'" y="'+s+'" '+d+" >"+i+"</text>",o.innerHTML+=u}function B(e,t){return 0==t||Math.abs(t)<1e-7?0:Math.abs(t)<.1?(t=Math.round(1e3*t),console.log("rounded number="+t),t/100+"*E-2"):Math.abs(t)>.1&&Math.abs(t)<1e3||0==t?(Math.round(t)!=t&&(t=Math.round(100*t)/100),t+""):(t=(t=t/Math.pow(10,e.pow)+"").length<3?t+=".0":t.substring(0,2))+"*E"+e.pow}function O(e,t){return!(e<y.min||e>y.max)&&!(t<y.min||t>y.max)}function I(e){b&&(b.innerHTML="",e.innerHTML="")}return function(){for(var e in h)n&&n.hasOwnProperty(e)&&(h[e]=n[e]);u.width=t,u.height=r,u.innerHTML="<svg  width='"+t+"' height='"+r+"' viewBox='0,0 "+t+" "+r+"' xmlns='http://www.w3.org/2000/svg'></svg>",r-=2*c,t-=2*c,o=u.getElementsByTagName("svg")[0],i=4*c+1.3*C,d=3*c,a=r-2*c,l=t-2*c,s=2*c,C<10&&(!0,C=12),T()}(),{setAxisLabels:function(e,t){A=e,k=t},create:M,hasVisibleValues:function(e){v=e},chartColor:function(e){x=e},simpleChart:function(e,t){if(t.max&&t.min&&!(e.getElementsByTagName("svg").length>0)){var r,n,o,i,a,l,s=e.width-3*c,d=e.height-3*c,u=d-5*c,f=C+2*c,g=s-4*c,v=g/6;for(r in e.innerHTML="<svg  width='"+s+"' height='"+d+"' viewBox='0,0 "+s+" "+d+"' xmlns='http://www.w3.org/2000/svg'></svg>",(b=e.getElementsByTagName("svg")[0]).setAttribute("style","cursor:pointer"),b.onclick=function(){I(e),e.setAttribute("class","noSize")},function(){for(var e in r=1,n=t.min,o=t.max,l=0,a=f+(i=u/(o-n))*o,b.innerHTML+='<rect x="10" y="10" rx="'+5*m+'" ry="'+5*m+'" width="'+(s-20)+'" height="'+(d-20)+'" fill="'+h.bgCol+'" stroke="'+h.borderCol+'" stroke-width="'+m+'" />',t)"min"!=e&&"max"!=e&&(0==l&&t[e].points.length>0&&(l=(g-v)/t[e].points.length),x=t[e].name,w=t[e].color,p=c+r*C,b.innerHTML+='<text x="'+3*c+'" y="'+p+'" fill="'+w+'"  font-size="'+C+'" >'+x+"</text>",r++);var x,w,p,y,A,k,M;o>0&&n<0&&(y=v,A=g,k=a,M=C,b.innerHTML+='<text x="'+(y-c)+'" y="'+(k+M/2)+'"  stroke="'+h.axisCol+'" stroke-width="'+2*m/3+'"  font-size="'+2*M/3+'" text-anchor="end" >0</text>',b.innerHTML+='<line x1="'+y+'" y1="'+k+'" x2="'+A+'"  y2="'+k+'" stroke="'+h.axisCol+'" stroke-width="'+m/2+'" />')}(),t)"min"!=r&&"max"!=r&&w(t[r].points);var x=!1}function w(e){e instanceof Array&&e.length>0&&("number"==typeof e[0]?function(e){for(var n=e[0],o=e[0],s='<polyline points="',d=0;d<e.length;d++)e[d]>o&&(o=e[d]),e[d]<n&&(n=e[d]),s+=v+d*l+","+(a-i*e[d])+" ";s+='" fill="none" stroke="'+t[r].color+'"  stroke-width="'+m+'" />',o=Math.round(o),n=Math.round(n),p(o,n,a-i*o,a-i*n,t[r].color),b.innerHTML+=s}(e):function(e){for(var n,o,s,d,c=Math.round(2*C/3),g=e[0].val,x=e[0].val,w='<polyline points="',A=[],k=0;k<e.length;k++)if((d=e[k].val)>g&&(g=d),d<x&&(x=d),w+=(o=v+k*l)+","+(s=a-i*d)+" ",e[k].svg&&(s<60&&(s=60),s>u-60&&(s=u-60),(n=e[k].svg).setAttribute("x",o-n.getAttribute("width")/3),n.setAttribute("y",s-n.getAttribute("height")+4),A[k]=n),e[k].text){var M=e[k].text.split(/\n/);b.innerHTML+='<line x1="'+o+'" y1 ="'+f+'"  x2="'+o+'" y2="'+(u-M.length*c)+'" stroke="'+h.axisCol+'"  stroke-width="'+m/3+'" />',1==M.length?b.innerHTML+='<text x="'+o+'" y="'+u+'"  font-size="'+c+'" text-anchor="middle"  stroke="'+h.labelCol+'" stroke-width="1" >'+e[k].text+"</text>":y(o,M,c)}for(k in w+='" fill="none" stroke="'+t[r].color+'"  stroke-width="'+m+'" />',b.innerHTML+=w,g=Math.round(g),x=Math.round(x),p(g,x,a-i*g,a-i*x,t[r].color),A)b.appendChild(A[k])}(e))}function p(e,t,r,n,o){var i="",a=x?g:g-C;x=!x;var l='stroke="'+o+'"  stroke-width="'+m/2+'" ',s='font-size="'+2*C/3+'" text-anchor="end" ';i+='<line x1="'+v+'" y1="'+n+'" x2="'+g+'" y2="'+n+'" '+l+" />",i+='<text x="'+a+'" y="'+(n-2)+'" '+l+s+">"+t+"</text>",i+='<line x1="'+v+'" y1="'+r+'" x2="'+g+'" y2="'+r+'" '+l+" />",i+='<text x="'+a+'" y="'+(r+2*C/3)+'" '+l+s+">"+e+"</text>",b.innerHTML+=i}function y(e,t,r){for(var n=u-(t.length-1)*r+2*m,o=0;o<t.length;o++)b.innerHTML+='<text x="'+e+'" y="'+(n+o*r)+'" font-size="'+r+'" text-anchor="middle" stroke="'+h.labelCol+'" stroke-width="1" >'+t[o]+"</text>"}},clearSimpleChart:I}}function MeteoViewer(){var e,t,r,n,o,i,a=2025,l=function(e,t){return e.length<3?"":(e=e.trim().substring(0,3).toLowerCase(),t?word[e]:shortWord[e])},s=[],d="http://www.w3.org/2000/svg";function h(){if(!(s.length<2||document.body.clientWidth<document.body.clientHeight)){var t=function(e){for(var t=[],r=[],n={},o=e[0].max,i=e[0].min,a=0;a<e.length;a++){e[a].max>o&&(o=e[a].max),e[a].min<i&&(i=e[a].min);var l=document.createElementNS(d,"image");l.setAttribute("width","52"),l.setAttribute("height","52"),l.setAttributeNS(d,"xlink:href",e[a].picture),t[a]=e[a].min,r[a]={val:e[a].max,svg:l,text:e[a].date}}return n.min=Math.round(i-(o-i)/5),n.max=Math.round(o+(o-i)/10),n.label={name:"&nbsp; &nbsp;"+word.forecast,color:"#752",points:[]},n.space0={name:"",color:"rgba(0,0,0,0)",points:[]},n.maxThemp={name:word.day+" t℃",color:"#909",points:r},n.space1={name:"",color:"rgba(0,0,0,0)",points:[]},n.minThemp={name:word.night+" t℃",color:"#069",points:t},n}(s);null==i&&(i=document.createElement("div")),i.setAttribute("class","bigSize");var r=document.createElement("div");r.width=4*document.body.scrollWidth/5,r.height=5*document.body.scrollHeight/6,r.setAttribute("style","margin-top:"+document.body.scrollHeight/12+"px"),i.appendChild(r),document.body.appendChild(i),e.simpleChart(r,t),i.onclick=function(){e.clearSimpleChart(r),i.setAttribute("class","noSize")}}}return{createDevPanel:function(){var e={devBordStartCol:"rgba(75,95,130,0.3)"},i={label:"&nbsp;t℃"};return t=new Measurer(document.getElementsByName("inThermOwner")[0],{colors:e,bounds:{minValue:0,maxValue:40,scaleDeviceCount:20},rect:i}),r=new Measurer(document.getElementsByName("outThermOwner")[0],{colors:e,bounds:{minValue:-50,maxValue:50,scaleDeviceCount:30},rect:i}),e={devBordStopCol:"rgba(80,90,10,0.2"},n=new Measurer(document.getElementsByName("baroOwner")[0],{bounds:{minValue:650,maxValue:810,scaleDivideCount:16},oval:{label:"&nbsp;"+word["baro.label"],startAngle:-35,stopAngle:215,hasRound:!1},colors:e}),o=new Measurer(document.getElementsByName("hygroOwner")[0],{bounds:{minValue:0,maxValue:100,scaleDeviceCount:10},oval:{startAngle:-10,stopAngle:190,label:"&nbsp;%",hasRound:!1},colors:e}),{indoorTherm:t,outdoorTherm:r,barometer:n,hygrometer:o}},createActivityPanel:function(e){if(document.body.clientWidth<document.body.clientHeight)return null;if(!(e instanceof HTMLElement))return console.log("ERROR can`t create activity panel: I get not HTMLElement:"+e),null;var t,r=["   ","Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],n=[word.all,word.jan,word.feb,word.mar,word.apr,word.may,word.jun,word.jul,word.aug,word.sep,word.oct,word.nov,word.dec],o=document.forms.checkDuration,i=o.getElementsByTagName("label"),l=function(){for(u.setAttribute("disabled","disabled"),c.setAttribute("disabled","disabled"),m.setAttribute("disabled","disabled"),t=0;t<i.length;t++)i[t].setAttribute("class","label")},s=o.elements.sensorSelect,d={empty:"",tOut:word["tOut.text"],tIn:word["tIn.text"],baro:word["baro.text"],humid:word["humid.text"]};for(t in d)s.appendChild(new Option(d[t],t));var h=o.elements.intervalSelect;h.appendChild(new Option("  ","empty")),h.appendChild(new Option("  "+word.lastHour+" ","lastHour")),h.appendChild(new Option(word.checkInterval,"checkInterval")),h.setAttribute("disabled","disabled");var u=o.elements.yearSelect;for(u.appendChild(new Option("","empty")),t=2018;t<a+1;t++)u.appendChild(new Option(t,t+""));for(t=0;t<u.getElementsByTagName("option").length;t++)u.getElementsByTagName("option")[t].setAttribute("style","color:");u.setAttribute("disabled","disabled");var c=o.elements.monthSelect;for(t=0;t<r.length;t++)c.appendChild(new Option(n[t],r[t]));c.setAttribute("disabled","disabled");var m=o.elements.daySelect;for(m.appendChild(new Option(word.all," ")),t=1;t<32;t++)m.appendChild(new Option(t+"",t));m.setAttribute("disabled","disabled");var f=o.elements.submitButton;return f.setAttribute("value","getChart"),f.setAttribute("disabled","disabled"),f.setAttribute("class","submitButton"),f.innerHTML=word.build,l(),o.addEventListener("click",function(e){0==s.selectedIndex&&(h.setAttribute("disabled","disabled"),l()),s.selectedIndex>0&&h.hasAttribute("disabled")&&h.removeAttribute("disabled"),s.selectedIndex>0&&1==h.selectedIndex&&l()},!1),o},createChart:function(t){if(document.body.clientWidth<document.body.clientHeight)return null;var r=document.body.clientWidth-1.1*document.getElementsByTagName("aside")[0].offsetWidth,n=getComputedStyle(document.getElementsByTagName("aside")[0]).padding;n=n.substring(0,n.length-2);var o=document.getElementsByName("informer")[0].clientHeight,i=document.getElementsByTagName("aside")[0].clientHeight-Math.max(document.getElementsByName("activityPanel")[0].offsetHeight,o)-4*n;return e=new Plotter(t,r,i,{borderCol:getComputedStyle(document.getElementsByTagName("table")[0]).borderColor})},createInformer:function(e,t){var r;(r=document.createElement("div")).setAttribute("class","inlineTop informerFore"),r.onclick=h,r.innerHTML=word.forecastButtonName,e.appendChild(r);var n=document.createElement("div");n.setAttribute("class","informerBoard inlineTop wavesBackGround");var o,i=t.query.results.channel;!function(e){var t=document.createElement("a");t.setAttribute("href",e.link),t.setAttribute("target","_blank"),t.setAttribute("style","text-align:center");var r=document.createElement("img");r.setAttribute("src",e.url),r.setAttribute("width",e.width),r.setAttribute("height",e.height),r.setAttribute("alt",e.title),r.setAttribute("class","informerImgBord logo right"),t.appendChild(r),n.appendChild(t)}(i.image),function(e,t){var r=(new Date).getHours(),a=(new Date).getMinutes()/100;r+=a;var l=i.astronomy.sunrise+"";l=1*(l=l.substring(0,l.indexOf(" ")).replace(":","."));var s=i.astronomy.sunset+"";s=12+1*(s=s.substring(0,s.indexOf(" ")).replace(":","."));var d=r>l&&r<s?"left imgDay informerImgBord":"left imgNight informerImgBord",h=e.substring(9,e.indexOf(">")+1);(o=document.createElement("div")).setAttribute("class",d),o.innerHTML=h,n.appendChild(o)}(i.item.description);var a=i.atmosphere,d=i.item.forecast;function u(e,t){var r=t?"\n":"&nbsp;",n=l(e.split(" ")[1],t);return t||(n=n.indexOf("ь")>0||n.indexOf("й")>0?n.substring(0,n.length-1)+"я":n+"а"),e.split(" ")[0]+r+n}return function(e,t){var r=t.date;r=l(t.day,!0)+"&nbsp;"+u(r,!1);var o=document.createElement("div");o.setAttribute("class","informerText");var i='<div><span class="informer labelColor"> '+r+'</span></div><span  class="informer labelColor">'+word["humid.label"]+" "+e.humidity+'&nbsp;%</span><br /><span  class="informer labelColor">'+word.pressure+"&nbsp;"+(e.pressure/1e3*750.0637+"").substring(0,3)+"&nbsp;"+word["baro.label"]+'</span><div style="margin-top: 0.3em;margin-bottom: 3px">&nbsp;<span  class="informerDay">'+word.day+": "+(5*(t.high-32)/9+"").substring(0,4)+' ℃ </span>&nbsp;<span class="informerNight">'+word.night+": "+(5*(t.low-32)/9+"").substring(0,4)+" ℃ &nbsp;</span></div>";o.innerHTML+=i,n.appendChild(o)}(a,d[0]),function(e){for(var t=0;t<e.length;t++){var r={};r.picture="http://l.yimg.com/a/i/us/we/52/"+e[t].code+".gif",r.max=Math.round(500*(e[t].high-32)/9)/100,r.min=Math.round(500*(e[t].low-32)/9)/100,r.date=l(e[t].day,!0)+" "+u(e[t].date,!0),s[t]=r}}(d),e.appendChild(n),{end:"yes"}},showForecast:h}}window.debug||(debug=!1);var chartBoard,serverRoot="http://"+window.location.host+"/";console.log("debug="+debug),debug&&console.log(" start test execution ON host:"+serverRoot),debug&&console.log("Browser: '"+navigator.userAgent+"'  "),function(){var e,t=new MeteoViewer,r=t.createDevPanel();t.createActivityPanel(document.getElementsByName("activityPanel")[0]);var n=setInterval(function(){e||o>4?(clearInterval(n),chartBoard=t.createChart(document.getElementById("graphCanvas")),o>4&&!debug&&alert(word.informerAlert)):yahooWeatherData?e=t.createInformer(document.getElementsByName("informer")[0],yahooWeatherData):console.log("Can`t get data from Yahoo Weather");o++},1e3),o=0;function i(){get(serverRoot+"current",a)}function a(e){e&&debug&&console.log("GET DATA:"+JSON.stringify(e));try{r.indoorTherm.setValue(e.tIn),r.hygrometer.setValue(e.humid),r.barometer.setValue(e.baro),r.outdoorTherm.setValue(e.tOut)}catch(e){console.log("in setDeviceValues ERROR\n"+e.name+" "+e.message)}}setTimeout(i,2500),setInterval(i,2e4)}(),function(){var e={},t=document.forms.checkDuration,r=t.elements.submitButton;r.setAttribute("disabled","disabled"),r.addEventListener("click",function(){var e,r,l,h=(f=d(t.elements.sensorSelect),g=s[f],g.name=f,g);var f,g;1===n.selectedIndex&&(e="lastValues?sensor="+h.name,get(e,function(e){e?function(e,t){var r,n,o,i="    "+word.time,a=e.text,l={values:function(e){n=t.last,r=new Array(t[e].length),o=r.length;for(var i=0;i<o;i++)r[i]=t[e][i];for(n=o+n+1,i=0;i<o;i++)r[i]=t[e][(n+i)%o];return r}(e.name),xAxisLabels:function(){var e,t,r=new Date,n=[];r.setSeconds(r.getSeconds()-3900);for(var o=0;o<13;o++)r.setSeconds(r.getSeconds()+300),e=(e=r.getHours())>9?e:"0"+e,t=(t=r.getMinutes())>9?t:"0"+t,n[o]=e+":"+t;return n}()};c(i,e.yLabel,e.color,a,l,e.edges)}(h,e):console.log("not get data")}));if(2===n.selectedIndex)if(l=d(o),i.selectedIndex>0){if(r=d(i),!function(e,t){var r=!0;(r=m.hasOwnProperty(e)&&m[e]instanceof Array)&&(r=m[e].indexOf(t)>=0);return r}(l,r))return console.log('test.js: such interval NOT FOUND "'+l+"/"+r+'"'),void alert("Error");var v=l+"/"+r+".txt";b(v,function(e){a.selectedIndex<1?u(h,e):function(e,t,r){for(var n=t.split("\n"),a=[],l=[],s=0,h=n.length-1,u=0;u<h;u++)if(n[u]=n[u].trim(),!(n[u].length<3)){var m=n[u].split(/\s/),f=NaN;if(m[0].length>1){var g="0"===m[0].charAt(0)?Number(m[0].charAt(1)):Number(m[0]);g===r&&(0==s?m[1]:m[1],f=Number(m[e.numInData]),!isNaN(f)&&f>e.edges.min&&f<e.edges.max&&(a[s]=f,l[s]=m[1],s++))}else console.log("Error dayData is not String-'"+m[0]+"'  dayD[1]="+m[1])}var b=word.hour,v=i.getElementsByTagName("option")[i.selectedIndex].innerHTML;v.length>3&&(v=v.substr(0,3)+". ");var x=" "+e.text+word.by+r+" "+v+" "+d(o)+word.year,w=e.edges;a.length<1?c("","","red",word.noDataFor+x,[0,0,0,0,0,0],{min:-1,max:1}):a.length===l.length&&(a={values:a,xAxisLabels:l});c(b,e.yLabel,e.color,x,a,w)}(h,e,a.selectedIndex)})}else!function(e,t){var r,n,o,a=[],l=[],s=0,h=word.month,f=word.baro+word.by+t+word.year,g=!1;return function(e,t){var r={};if(debug&&console.log("test.js [ start fill data for year "+e+" ]"),m.hasOwnProperty(e)){var n=m[e];n.length<1&&t(r);var o=0;!function i(a){var l=e+"/"+n[o]+".txt";b(l,function(e){e&&(r[n[o]]=e),++o==n.length?t(r):i(o)})}()}else t(r)}(t,function(m){if("{}"==JSON.stringify(m))return console.log("test.js(drawYearChart) - Get empty year data for "+t),alert(word.noDataFor+t),c("","","red","",[0,0,0,0,0],{min:-1,max:1}),1;var v,x;for(var w in m){for(console.log("parse montchs p="+w),g||(g=w),a[s]=shortWord[(w+"").toLowerCase()],r=m[w].split("\n"),n=r.length-1,o=0,v=0;v<n;v++)(x=Number(r[v].trim().split(/\s/)[e.numInData]))<e.edges.min||x>e.edges.max||(o+=x);l[s]=o>0?parseInt(o/(v+1)+.5001):parseInt(o/(v+1)-.5001),s++}if(1==a.length){debug&&console.log("test.js try draw year chart as Month");var p=i.getElementsByTagName("option");for(v=0;v<p.length;v++)p[v].getAttribute("value").indexOf(g)>-1&&p[v].setAttribute("selected","selected");b(t+"/"+d(i)+".txt",function(t){return u(e,t),!0})}return debug&&console.log("year chart: [ "+a+" ]     [ "+l+" ]"),1!=a.length&&c(h,e.yLabel,e.color,f,{values:l,xAxisLabels:a},e.edges),!1}),setTimeout((v=word.noDataFor+" "+e.text+word.by+t+word.year,void(s<1&&c("","","red",v,[0,0,0,0],{min:-1,max:1}))),6e3),!0;var v}(h,l)});var n=t.elements.intervalSelect;n.addEventListener("click",function(){1==n.selectedIndex&&r.hasAttribute("disabled")&&r.removeAttribute("disabled");if(2==n.selectedIndex){var e=serverRoot+"availablePeriod";get(e,f),m&&(document.getElementsByName("fYearLabel")[0].style.color="#403030",document.getElementsByName("fMonthLabel")[0].style.color="#404030")}});var o=t.elements.yearSelect;o.addEventListener("click",function(){if(o.selectedIndex<1)return;for(var e=i.getElementsByTagName("option"),t=m[d(o)],n=1;n<e.length;n++)t.indexOf(e[n].getAttribute("value"))<0?e[n].setAttribute("disabled","disabled"):e[n].hasAttribute("disabled")&&e[n].removeAttribute("disabled");e[0].hasAttribute("disabled")&&e[0].removeAttribute("disabled");i.selectedIndex=0,a.selectedIndex=0,a.hasAttribute("disabled")||a.setAttribute("disabled","disabled");t.length>0&&(r.hasAttribute("disabled")&&r.removeAttribute("disabled"),i.hasAttribute("disabled")&&i.removeAttribute("disabled"))});var i=t.elements.monthSelect;i.addEventListener("click",function(){if(i.selectedIndex<1)return;b(d(o)+"/"+d(i)+".txt",function(e){e&&function(e){var t=e.split("\n");if(t.length<1)return;for(var r,n=[],o=-1,i=0,l=0;l<t.length;l++)(r=t[l].trim().split(/\s/)[0])!=o&&(n[i]=r,o=r,i++);var s,d=a.getElementsByTagName("option");for(a.selectedIndex=0,l=0;l<d.length;l++)(s=d[l].getAttribute("value"))<9&&(s="0"+s),n.indexOf(s)<0?d[l].setAttribute("disabled","disabled"):d[l].hasAttribute("disabled")&&d[l].removeAttribute("disabled");a.hasAttribute("disabled")&&a.removeAttribute("disabled");d[0].hasAttribute("disabled")&&d[0].removeAttribute("disabled")}(e)})});var a=t.elements.daySelect,l="sensorData?period=",s={tIn:{edges:{min:0,max:40},yLabel:word["tIn.label"],color:"#a85",text:word["tOut.text"],numInData:2},tOut:{edges:{min:-50,max:50},yLabel:word["tOut.label"],color:"#959",text:word["tOut.text"],numInData:3},baro:{edges:{min:600,max:800},yLabel:word["baro.label]"],color:"gray",text:word["baro.text"],numInData:4},humid:{edges:{min:0,max:100},yLabel:word["humid.label"],color:"#46b",text:word["hunid.text"],numInData:5}};i.addEventListener("click",function(){i.selectedIndex>0&&a.hasAttribute("disabled")&&(a.removeAttribute("disabled"),document.getElementsByName("fDayLabel")[0].style.color="#403030"),i.selectedIndex<1&&!a.hasAttribute("disabled")&&(a.setAttribute("disabled","disabled"),document.getElementsByName("fDayLabel")[0].style.color="#ac9999")});var d=function(e){return e.getElementsByTagName("option")[e.selectedIndex].getAttribute("value")},h=function(e){return e.getElementsByTagName("option")[e.selectedIndex].innerHTML};function u(e,t){debug&&console.log("drawMonthChart for sensor="+e.name+"  month="+d(i)+" data: \n "+t+"\n____EOF___");var r=t.split("\n"),n=r.length-1,a=h(i)+" "+d(o)+word.year,l=word.number;if(n<0)c("","","#f99",word.noDataFor+" "+e.text+word.by+a,[0,0,0,0,0,0,0],{min:-1,max:1});else{var s=[],u=[],m=r[0].trim().split(/\s/),f=m[0],g=1,b=Number(m[e.numInData]);(isNaN(b)||b<e.edges.min||b>e.edges.max)&&(b=0);for(var v=0,x=0,w=1;w<r.length;w++)if(f==(m=r[w].trim().split(/\s/))[0]){if(x=Number(m[e.numInData]),isNaN(x)||x>e.edges.max||x<e.edges.min)continue;b+=x,g++}else w<n?(u[v]=f,s[v]=b<0?parseInt(b/g-.5001):parseInt(b/g+.5001),f=m[0],b=Number(m[e.numInData]),g=1,v++):(u[v]=f,s[v]=b<0?parseInt(b/g-.5001):parseInt(b/g+.5001));if(0!=v){var p=" "+e.text+word.by+a,y={values:s,xAxisLabels:u};c(l,e.yLabel,e.color,p,y,e.edges)}else c(l,"     ",e.color,word.by+f+"/"+a+" "+word.meanFor+e.text+" = "+s[0],[0,0,0,0],{min:-1,max:1})}}function c(e,t,r,n,o,i){chartBoard.setAxisLabels(e,t),chartBoard.chartColor(r),chartBoard.create(n,o,i)}var m={};function f(e){var t;if(e&&e instanceof Array&&!(e.length<1)){var n,l="",s=0;for(var d in e){var h=e[d].substring(6,10);debug&&d<1&&console.log("First year = "+h),l!=h?(""!=l&&g(l,n),n=[],l=h,s=0):s++,t=e[d].substring(11,14),n[s]=t}""!=l&&g(l,n),debug&&console.log("availablePeriods: "+JSON.stringify(m)),function(){for(var e=o.getElementsByTagName("option"),t=!1,n=0;n<e.length;n++)m[e[n].getAttribute("value")]?(e[n].hasAttribute("disabled")&&e[n].removeAttribute("disabled"),t||(o.selectedIndex=n,t=!0)):e[n].setAttribute("disabled","disabled");i.selectedIndex=0,a.selectedIndex=0,e.length>0&&(r.hasAttribute("disabled")&&r.removeAttribute("disabled"),o.hasAttribute("disabled")&&o.removeAttribute("disabled"))}()}else m={}}function g(e,t){m[e]=t}function b(t,r){e.hasOwnProperty(t)?(debug&&console.log("get data from cache"),r(e[t])):(debug&&console.log("test.js try get data from server"),get(l+t,function(n){if(n){var o=function(e){var t,r="",n=e.split("\n");if(n.length<1)return!1;for(var o=0;o<n.length;o++)n[o].search(/[^\s\d-]/)>-1||6==(t=n[o].trim().split(/\s/)).length&&(isNaN(t[2])||t[2]>1e3||t[2]<-1e3||isNaN(t[3])||t[3]>1e3||t[3]<-1e3||isNaN(t[4])||t[4]>1e3||t[4]<-1e3||isNaN(t[5])||t[5]>1e3||t[5]<-1e3||(r+=n[o]+"\n"));return!(r.length<14)&&r}(n);o?function(t,r){if(e.hasOwnProperty(t))return!1;e[t]=r}(t,o):console.log("test.js [ GET WRONG DATA FOR PERIOD "+t+" ] "),r(o)}else console.log("test.js [ GET EMPTY DATA FOR PERIOD "+t+" ] "),r(!1)}))}}();